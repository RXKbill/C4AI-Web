<!doctype html>
<html lang="en">

    <head>

        <meta charset="utf-8">
        <title>驭能能源管理系统</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="Premium Multipurpose Admin & Dashboard Template" name="description">
        <meta content="Themesbrand" name="author">

        <!-- plugin css -->
        <link href="static/css/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css">

        <!-- preloader css -->
        <link rel="stylesheet" href="static/css/preloader.min.css" type="text/css">

        <!-- 添加 SweetAlert2 CSS -->
        <link href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-dark@4/dark.css" rel="stylesheet">
        
        <!-- Bootstrap Css -->
        <link href="static/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css">
        <!-- Icons Css -->
        <link href="static/css/icons.min.css" rel="stylesheet" type="text/css">
        <!-- App Css-->
        <link href="static/css/app.min.css" id="app-style" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="static/css/system_management.css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
        <!-- Add Remixicon CSS -->
        <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

        <!-- 设备检修管理样式 -->
        <link rel="stylesheet" href="static/css/maintenance-management.css">

        <link rel="stylesheet" href="static/css/business-processor.css">
        <link href="static/css/charging-station.css" rel="stylesheet" type="text/css">
        <!-- 添加ECharts依赖 -->
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/map/js/china.js"></script>

        <!-- 添加 SweetAlert2 JS -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>

        <!-- 添加自定义 SweetAlert2 配置 -->
        <script>
            // 配置 SweetAlert2 默认选项
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
                background: '#2a3042',
                color: '#fff',
                didOpen: (toast) => {
                    toast.addEventListener('mouseenter', Swal.stopTimer)
                    toast.addEventListener('mouseleave', Swal.resumeTimer)
                }
            });

            // 配置确认对话框默认选项
            const Confirm = Swal.mixin({
                showCancelButton: true,
                confirmButtonText: '确认',
                cancelButtonText: '取消',
                background: '#2a3042',
                color: '#fff'
            });

            // 覆盖默认的 window.confirm
            window.confirm = function(message) {
                return Confirm.fire({
                    title: message,
                    icon: 'question'
                });
            };

            // 覆盖默认的 window.alert
            window.alert = function(message) {
                return Toast.fire({
                    title: message,
                    icon: 'info'
                });
            };
        </script>
    </head>

    <body data-layout-mode="dark" data-topbar="dark" data-sidebar="dark" class="sidebar-enable">

    <!-- <body data-layout="horizontal"> -->

        <!-- Begin page -->
        <div id="layout-wrapper">
            <header id="page-topbar">
                <div class="navbar-header">
                    <div class="d-flex">
                        <!-- LOGO -->
                        <div class="navbar-brand-box">
                            <a href="" class="logo logo-dark">
                                <span class="logo-sm">
                                    <img src="static/picture/logo.png" alt="" height="24">
                                </span>
                                <span class="logo-lg">
                                    <img src="static/picture/logo.png" alt="" height="24"> <span class="logo-txt">驭能能源管理系统</span>
                                </span>
                            </a>

                            <a href="" class="logo logo-light">
                                <span class="logo-sm">
                                    <img src="static/picture/logo.png" alt="" height="24">
                                </span>
                                <span class="logo-lg">
                                    <img src="static/picture/logo.png" alt="" height="24"> <span class="logo-txt">驭能能源管理系统</span>
                                </span>
                            </a>
                        </div>

                        <button type="button" class="btn btn-sm px-3 font-size-16 header-item" id="vertical-menu-btn">
                            <i class="fa fa-fw fa-bars"></i>
                        </button>

                        <!-- App Search-->
                        <form class="app-search d-none d-lg-block">
                            <div class="position-relative">
                                <input type="text" class="form-control" placeholder="Search...">
                                <button class="btn btn-primary" type="button"><i class="bx bx-search-alt align-middle"></i></button>
                            </div>
                        </form>
                    </div>

                    <div class="d-flex">

                        <div class="dropdown d-inline-block d-lg-none ms-2">
                            <button type="button" class="btn header-item" id="page-header-search-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i data-feather="search" class="icon-lg"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0" aria-labelledby="page-header-search-dropdown">
        
                                <form class="p-3">
                                    <div class="form-group m-0">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Search ..." aria-label="Search Result">

                                            <button class="btn btn-primary" type="submit"><i class="mdi mdi-magnify"></i></button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <div class="dropdown d-none d-sm-inline-block">
                            <button type="button" class="btn header-item" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img id="header-lang-img" src="static/picture/cn.png" alt="Header Language" height="16">
                            </button>
                            <div class="dropdown-menu dropdown-menu-end">

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="en">
                                    <img src="static/picture/cn.png" alt="user-image" class="me-1" height="12"> <span class="align-middle">Chinese</span>
                                </a>
                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="sp">
                                    <img src="static/picture/spain.jpg" alt="user-image" class="me-1" height="12"> <span class="align-middle">Spanish</span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="gr">
                                    <img src="static/picture/germany.jpg" alt="user-image" class="me-1" height="12"> <span class="align-middle">German</span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="it">
                                    <img src="static/picture/italy.jpg" alt="user-image" class="me-1" height="12"> <span class="align-middle">Italian</span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item language" data-lang="ru">
                                    <img src="static/picture/russia.jpg" alt="user-image" class="me-1" height="12"> <span class="align-middle">Russian</span>
                                </a>
                            </div>
                        </div>

                        <div class="dropdown d-none d-sm-inline-block">
                            <button type="button" class="btn header-item" id="mode-setting-btn">
                                <i data-feather="moon" class="icon-lg layout-mode-dark"></i>
                                <i data-feather="sun" class="icon-lg layout-mode-light"></i>
                            </button>
                        </div>

                        <div class="dropdown d-none d-lg-inline-block ms-1">
                            <button type="button" class="btn header-item" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i data-feather="grid" class="icon-lg"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
                                <div class="p-2">
                                    <div class="row g-0">
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/github.png" alt="Github">
                                                <span>GitHub</span>
                                            </a>
                                        </div>
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/bitbucket.png" alt="bitbucket">
                                                <span>Bitbucket</span>
                                            </a>
                                        </div>
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/dribbble.png" alt="dribbble">
                                                <span>Dribbble</span>
                                            </a>
                                        </div>
                                    </div>

                                    <div class="row g-0">
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/dropbox.png" alt="dropbox">
                                                <span>Dropbox</span>
                                            </a>
                                        </div>
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/mail_chimp.png" alt="mail_chimp">
                                                <span>Mail Chimp</span>
                                            </a>
                                        </div>
                                        <div class="col">
                                            <a class="dropdown-icon-item" href="#">
                                                <img src="static/picture/slack.png" alt="slack">
                                                <span>Slack</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="dropdown d-inline-block">
                            <button type="button" class="btn header-item noti-icon position-relative" id="page-header-notifications-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i data-feather="bell" class="icon-lg"></i>
                                <span class="badge bg-danger rounded-pill">5</span>
                            </button>
                            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0" aria-labelledby="page-header-notifications-dropdown">
                                <div class="p-3">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h6 class="m-0"> Notifications </h6>
                                        </div>
                                        <div class="col-auto">
                                            <a href="#!" class="small text-reset text-decoration-underline"> Unread (3)</a>
                                        </div>
                                    </div>
                                </div>
                                <div data-simplebar="" style="max-height: 230px;">
                                    <a href="#!" class="text-reset notification-item">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 me-3">
                                                <img src="static/picture/avatar-3.jpg" class="rounded-circle avatar-sm" alt="user-pic">
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">James Lemire</h6>
                                                <div class="font-size-13 text-muted">
                                                    <p class="mb-1">It will seem like simplified Chinese.</p>
                                                    <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span>1 hours ago</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="#!" class="text-reset notification-item">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 avatar-sm me-3">
                                                <span class="avatar-title bg-primary rounded-circle font-size-16">
                                                    <i class="bx bx-cart"></i>
                                                </span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">Your order is placed</h6>
                                                <div class="font-size-13 text-muted">
                                                    <p class="mb-1">If several languages coalesce the grammar</p>
                                                    <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span>3 min ago</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="#!" class="text-reset notification-item">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 avatar-sm me-3">
                                                <span class="avatar-title bg-success rounded-circle font-size-16">
                                                    <i class="bx bx-badge-check"></i>
                                                </span>
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">Your item is shipped</h6>
                                                <div class="font-size-13 text-muted">
                                                    <p class="mb-1">If several languages coalesce the grammar</p>
                                                    <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span>3 min ago</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </a>

                                    <a href="#!" class="text-reset notification-item">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0 me-3">
                                                <img src="static/picture/avatar-6.jpg" class="rounded-circle avatar-sm" alt="user-pic">
                                            </div>
                                            <div class="flex-grow-1">
                                                <h6 class="mb-1">Salena Layfield</h6>
                                                <div class="font-size-13 text-muted">
                                                    <p class="mb-1">As a skeptical Cambridge friend of mine occidental.</p>
                                                    <p class="mb-0"><i class="mdi mdi-clock-outline"></i> <span>1 hours ago</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                <div class="p-2 border-top d-grid">
                                    <a class="btn btn-sm btn-link font-size-14 text-center" href="javascript:void(0)">
                                        <i class="mdi mdi-arrow-right-circle me-1"></i> <span>View More..</span> 
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="dropdown d-inline-block">
                            <button type="button" class="btn header-item right-bar-toggle me-2">
                                <i data-feather="settings" class="icon-lg"></i>
                            </button>
                        </div>

                        <div class="dropdown d-inline-block">
                            <button type="button" class="btn header-item bg-soft-light border-start border-end" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img class="rounded-circle header-profile-user" src="static/picture/avatar-1.jpg" alt="Header Avatar">
                                <span class="d-none d-xl-inline-block ms-1 fw-medium">张明</span>
                                <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end">
                                <!-- item-->
                                <a class="dropdown-item" href="apps-contacts-profile.html"><i class="mdi mdi-face-profile font-size-16 align-middle me-1"></i> Profile</a>
                                <a class="dropdown-item" href="auth-lock-screen.html"><i class="mdi mdi-lock font-size-16 align-middle me-1"></i> Lock screen</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="auth-logout.html"><i class="mdi mdi-logout font-size-16 align-middle me-1"></i> Logout</a>
                            </div>
                        </div>

                    </div>
                </div>
            </header>

            <!-- ========== Left Sidebar Start ========== -->
            <div class="vertical-menu">
                <div data-simplebar="" class="h-100">

                    <!--- Sidemenu -->
                    <div id="sidebar-menu">
                        <!-- Left Menu Start -->
                        <ul class="metismenu list-unstyled" id="side-menu">
                            <li class="menu-title" data-key="t-menu">View</li>

                            <li>
                                <a href="app-index.html">
                                    <i data-feather="home"></i>
                                    <span data-key="t-dashboard">数据总览</span>
                                </a>
                            </li>
                            <li class="menu-title mt-2" data-key="t-components">Basic</li>
                            <li>
                                <a href="javascript: void(0);" class="has-arrow">
                                    <i data-feather="users"></i>
                                    <span data-key="t-authentication">个人界面</span>
                                </a>
                                <ul class="sub-menu" aria-expanded="false">
                                    <li>
                                        <a href="app-contacts-profile.html">
                                            <span data-key="t-calendar">个人信息</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="app-calendar.html">
                                            <span data-key="t-calendar">日程表</span>
                                        </a>
                                    </li>
        
                                    <li>
                                        <a href="app-chat.html">
                                            <span data-key="t-chat">聊天</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a href="app-contacts-list.html">
                                    <i data-feather="file-text"></i>
                                    <span data-key="t-pages">用户列表</span>
                                </a>
                            </li>

                            <li class="menu-title mt-2" data-key="t-components">Operations</li>

                            
                            <li>
                                <a href="app-system_management.html">
                                    <i data-feather="grid"></i>
                                    <span data-key="t-apps">系统设置</span>
                                </a>
                            </li>
                            <li>
                                <a href="app-data_management.html">
                                    <i data-feather="sliders"></i>
                                    <span data-key="t-tables">数据管理</span>
                                </a>
                            </li>
                            <li>
                                <a href="app-business_process.html">
                                    <i data-feather="briefcase"></i>
                                    <span data-key="t-components">业务处理</span>
                                </a>
                            </li>

                            <li>
                                <a href="app-equipment_management.html">
                                    <i data-feather="cpu"></i>
                                    <span data-key="t-icons">设备管理</span>
                                </a>
                            </li>
                            <li>
                                <a href="app-inference-demo.html">
                                    <i data-feather="trending-up"></i>
                                    <span data-key="t-inference">推理示例</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <!-- Sidebar -->
                </div>
            </div>
            <!-- Left Sidebar End -->

            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <div class="main-content">
                <div class="page-content">
                    <div class="container-fluid">
                        <!-- start page title -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                                    <h4 class="mb-sm-0 font-size-18">业务处理</h4>
                                </div>
                            </div>
                        </div>
                        <!-- end page title -->

                        <!-- 子页面导航 -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-bs-toggle="tab" href="#overview" role="tab">
                                            <span class="d-block d-sm-none"><i class="fas fa-home"></i></span>
                                            <span class="d-none d-sm-block">总览</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="tab" href="#power-dispatch" role="tab">
                                            <span class="d-block d-sm-none"><i class="fas fa-bolt"></i></span>
                                            <span class="d-none d-sm-block">电力调度</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="tab" href="#energy-trading" role="tab">
                                            <span class="d-block d-sm-none"><i class="fas fa-exchange-alt"></i></span>
                                            <span class="d-none d-sm-block">能源交易执行</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="tab" href="#equipment-maintenance" role="tab">
                                            <span class="d-block d-sm-none"><i class="fas fa-tools"></i></span>
                                            <span class="d-none d-sm-block">设备检修管理</span>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-bs-toggle="tab" href="#charging-management" role="tab">
                                            <span class="d-block d-sm-none"><i class="fas fa-charging-station"></i></span>
                                            <span class="d-none d-sm-block">充电桩管理</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Tab 内容区域 -->
                        <div class="tab-content">
                            <!-- 总览页面 -->
                            <div class="tab-pane active" id="overview" role="tabpanel">
                                <div class="row">
                                    <!-- 业务指标卡片 -->
                                    <div class="col-xl-12">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="card mini-stats-wid">
                                                    <div class="card-body">
                                                        <div class="d-flex">
                                                            <div class="flex-grow-1">
                                                                <p class="text-muted fw-medium">今日调度任务</p>
                                                                <h4 class="mb-0">15</h4>
                                                            </div>
                                                            <div class="mini-stat-icon avatar-sm rounded-circle bg-primary align-self-center">
                                                                <span class="avatar-title rounded-circle bg-primary">
                                                                    <i class="bx bx-trending-up font-size-24"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card mini-stats-wid">
                                                    <div class="card-body">
                                                        <div class="d-flex">
                                                            <div class="flex-grow-1">
                                                                <p class="text-muted fw-medium">交易执行量</p>
                                                                <h4 class="mb-0">￥24,500</h4>
                                                            </div>
                                                            <div class="avatar-sm rounded-circle bg-primary align-self-center mini-stat-icon">
                                                                <span class="avatar-title rounded-circle bg-primary">
                                                                    <i class="bx bx-dollar-circle font-size-24"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card mini-stats-wid">
                                                    <div class="card-body">
                                                        <div class="d-flex">
                                                            <div class="flex-grow-1">
                                                                <p class="text-muted fw-medium">检修任务</p>
                                                                <h4 class="mb-0">8</h4>
                                                            </div>
                                                            <div class="avatar-sm rounded-circle bg-primary align-self-center mini-stat-icon">
                                                                <span class="avatar-title rounded-circle bg-primary">
                                                                    <i class="bx bx-wrench font-size-24"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card mini-stats-wid">
                                                    <div class="card-body">
                                                        <div class="d-flex">
                                                            <div class="flex-grow-1">
                                                                <p class="text-muted fw-medium">充电桩状态</p>
                                                                <h4 class="mb-0">12/15</h4>
                                                                <small class="text-muted">在线/总数</small>
                                                            </div>
                                                            <div class="avatar-sm rounded-circle bg-primary align-self-center mini-stat-icon">
                                                                <span class="avatar-title rounded-circle bg-primary">
                                                                    <i class="bx bx-charging-station font-size-24"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <!-- 业务处理趋势图 -->
                                    <div class="col-xl-8">
                                        <div class="card">
                                            <div class="card-body">
                                                <h4 class="card-title mb-4">业务处理趋势</h4>
                                                <div id="business-trend-chart" class="apex-charts" dir="ltr"></div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 任务分布图 -->
                                    <div class="col-xl-4">
                                        <div class="card">
                                            <div class="card-body">
                                                <h4 class="card-title mb-4">任务分布</h4>
                                                <div id="task-distribution-chart" class="apex-charts" dir="ltr"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 业务执行记录表格 -->
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-center mb-4">
                                                    <h4 class="card-title mb-0">业务执行记录</h4>
                                                    <div>
                                                        <button class="btn btn-light me-2" id="export-records">导出记录</button>
                                                        <button class="btn btn-light" id="filter-records" data-bs-toggle="modal" data-bs-target="#filterModal">筛选</button>
                                                    </div>
                                                </div>

                                                <div class="table-responsive">
                                                    <table class="table table-centered table-nowrap mb-0" id="business-records-table">
                                                        <thead>
                                                            <tr>
                                                                <th>记录ID</th>
                                                                <th>业务类型</th>
                                                                <th>执行内容</th>
                                                                <th>目标对象</th>
                                                                <th>执行时间</th>
                                                                <th>完成时间</th>
                                                                <th>状态</th>
                                                                <th>操作</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>BIZ20240326001</td>
                                                                <td>调度指令</td>
                                                                <td>功率调整 (80kW → 120kW)</td>
                                                                <td>成都高新区A3站快充桩#5</td>
                                                                <td>2024-03-26 09:15:23</td>
                                                                <td>2024-03-26 09:16:45</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326002</td>
                                                                <td>交易执行</td>
                                                                <td>现货交易 (售电500MWh)</td>
                                                                <td>四川省电力交易中心</td>
                                                                <td>2024-03-26 10:30:00</td>
                                                                <td>2024-03-26 10:30:15</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326003</td>
                                                                <td>设备维护</td>
                                                                <td>定期检修 (光伏组件清洗)</td>
                                                                <td>绵阳光伏基地B区组件</td>
                                                                <td>2024-03-26 11:00:00</td>
                                                                <td>-</td>
                                                                <td><span class="badge bg-warning">执行中</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                    <button class="btn btn-sm btn-danger ms-1">取消</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326004</td>
                                                                <td>充电业务</td>
                                                                <td>快充服务 (120kW)</td>
                                                                <td>成都高新区A3站快充桩#3</td>
                                                                <td>2024-03-26 13:20:00</td>
                                                                <td>-</td>
                                                                <td><span class="badge bg-info">待执行</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                    <button class="btn btn-sm btn-danger ms-1">取消</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326005</td>
                                                                <td>调度指令</td>
                                                                <td>削峰填谷调节 (储能放电)</td>
                                                                <td>德阳储能电站#2</td>
                                                                <td>2024-03-26 14:00:00</td>
                                                                <td>2024-03-26 14:01:30</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326006</td>
                                                                <td>交易执行</td>
                                                                <td>调频服务 (±50MW)</td>
                                                                <td>四川电网AGC系统</td>
                                                                <td>2024-03-26 14:30:00</td>
                                                                <td>-</td>
                                                                <td><span class="badge bg-warning">执行中</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                    <button class="btn btn-sm btn-danger ms-1">取消</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326007</td>
                                                                <td>设备维护</td>
                                                                <td>应急维修 (变压器故障)</td>
                                                                <td>乐山变电站#3主变</td>
                                                                <td>2024-03-26 15:10:00</td>
                                                                <td>2024-03-26 16:45:00</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>BIZ20240326008</td>
                                                                <td>充电业务</td>
                                                                <td>慢充服务 (7kW)</td>
                                                                <td>成都天府新区B1站#12</td>
                                                                <td>2024-03-26 16:00:00</td>
                                                                <td>-</td>
                                                                <td><span class="badge bg-warning">执行中</span></td>
                                                                <td>
                                                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#recordDetailModal">查看</button>
                                                                    <button class="btn btn-sm btn-danger ms-1">取消</button>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 电力调度页面 -->
                            <div class="tab-pane" id="power-dispatch" role="tabpanel">
                                <!-- 顶部状态栏 -->
                                <div class="row mb-3">
                                    <div class="col-xl-12">
                                        <div class="card bg-primary">
                                            <div class="card-body p-2">
                                                <div class="row align-items-center">
                                                    <div class="col-sm-6">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0">
                                                                <div class="avatar-md">
                                                                    <div class="avatar-title bg-soft-light text-light rounded-circle fs-2">
                                                                        <i class="fas fa-bolt"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h4 class="text-white mb-1">电力调度控制中心</h4>
                                                                <p class="text-white-50 mb-0">实时监控 | 智能调度 | 安全管理</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="row text-end">
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">系统频率</div>
                                                                <h5 class="text-white mb-0">50.02 Hz</h5>
                                                            </div>
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">总发电功率</div>
                                                                <h5 class="text-white mb-0">856.3 MW</h5>
                                                            </div>
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">系统状态</div>
                                                                <h5 class="text-white mb-0"><i class="fas fa-circle text-success me-1"></i>正常</h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 主要内容区域 -->
                                <div class="row">
                                    <!-- 左侧：系统概览 -->
                                    <div class="col-xl-3">
                                        <div class="card">
                                            <div class="card-header bg-transparent border-bottom">
                                                <h5 class="card-title mb-0">系统概览</h5>
                                            </div>
                                            <div class="card-body">
                                                <!-- 电源构成 -->
                                                <div class="mb-4">
                                                    <h6 class="card-subtitle mb-3">电源构成</h6>
                                                    <div class="power-composition-chart" style="height: 200px;"></div>
                                                    <div class="mt-2">
                                                        <div class="d-flex justify-content-between mb-2">
                                                            <div class="d-flex align-items-center">
                                                                <i class="fas fa-circle text-primary me-2"></i>
                                                                <span>风电</span>
                                                            </div>
                                                            <span>320.5 MW</span>
                                                        </div>
                                                        <div class="d-flex justify-content-between mb-2">
                                                            <div class="d-flex align-items-center">
                                                                <i class="fas fa-circle text-success me-2"></i>
                                                                <span>光伏</span>
                                                            </div>
                                                            <span>425.8 MW</span>
                                                        </div>
                                                        <div class="d-flex justify-content-between">
                                                            <div class="d-flex align-items-center">
                                                                <i class="fas fa-circle text-warning me-2"></i>
                                                                <span>储能</span>
                                                            </div>
                                                            <span>110.0 MW</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 设备状态 -->
                                                <div class="mb-4">
                                                    <h6 class="card-subtitle mb-3">设备状态</h6>
                                                    <div class="device-status">
                                                        <div class="d-flex align-items-center mb-3">
                                                            <div class="flex-grow-1">
                                                                <h6 class="mb-0">风机组</h6>
                                                                <small class="text-muted">20台在线，2台离线</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <div class="progress" style="width: 100px; height: 6px;">
                                                                    <div class="progress-bar bg-success" style="width: 91%"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-center mb-3">
                                                            <div class="flex-grow-1">
                                                                <h6 class="mb-0">光伏组件</h6>
                                                                <small class="text-muted">15组在线，0组离线</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <div class="progress" style="width: 100px; height: 6px;">
                                                                    <div class="progress-bar bg-success" style="width: 100%"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-grow-1">
                                                                <h6 class="mb-0">储能系统</h6>
                                                                <small class="text-muted">4组在线，1组检修</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <div class="progress" style="width: 100px; height: 6px;">
                                                                    <div class="progress-bar bg-success" style="width: 80%"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 告警信息 -->
                                                <div>
                                                    <h6 class="card-subtitle mb-3">告警信息</h6>
                                                    <div class="alert-list">
                                                        <div class="alert alert-warning mb-2 p-2">
                                                            <small><i class="fas fa-exclamation-triangle me-1"></i>风机组#5振动超限</small>
                                                        </div>
                                                        <div class="alert alert-info mb-2 p-2">
                                                            <small><i class="fas fa-info-circle me-1"></i>储能系统#2检修中</small>
                                                        </div>
                                                        <div class="alert alert-success mb-0 p-2">
                                                            <small><i class="fas fa-check-circle me-1"></i>光伏组件清洗完成</small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- 指令执行历史 -->
                                        <div class="card mb-4">
                                            <div class="card-header bg-transparent border-bottom">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">指令执行历史</h5>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-light" onclick="powerDispatchCommands.exportHistory()">
                                                            <i class="ri-download-2-line"></i>
                                                        </button>
                                                        <button class="btn btn-light" onclick="powerDispatchCommands.clearHistory()">
                                                            <i class="ri-delete-bin-line"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="command-history" style="height: 250px;" data-simplebar>
                                                    <div class="timeline-vertical">
                                                        <div class="timeline-item">
                                                            <div class="timeline-time">10:30</div>
                                                            <div class="timeline-content">
                                                                <div class="d-flex align-items-center mb-1">
                                                                    <span class="badge bg-success me-2">已完成</span>
                                                                    <h6 class="mb-0">风机组功率调整</h6>
                                                                </div>
                                                                <p class="text-muted mb-0">将风机组#1-5功率调整至250MW</p>
                                                                <small class="text-muted">执行时间: 15秒</small>
                                                            </div>
                                                        </div>
                                                        <div class="timeline-item">
                                                            <div class="timeline-time">10:15</div>
                                                            <div class="timeline-content">
                                                                <div class="d-flex align-items-center mb-1">
                                                                    <span class="badge bg-success me-2">已完成</span>
                                                                    <h6 class="mb-0">光伏阵列角度调整</h6>
                                                                </div>
                                                                <p class="text-muted mb-0">将光伏阵列角度调整至32°</p>
                                                                <small class="text-muted">执行时间: 2分钟</small>
                                                            </div>
                                                        </div>
                                                        <div class="timeline-item">
                                                            <div class="timeline-time">10:00</div>
                                                            <div class="timeline-content">
                                                                <div class="d-flex align-items-center mb-1">
                                                                    <span class="badge bg-warning me-2">执行中</span>
                                                                    <h6 class="mb-0">储能系统充电</h6>
                                                                </div>
                                                                <p class="text-muted mb-0">储能系统充电功率50MW</p>
                                                                <small class="text-muted">已执行: 30分钟</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 中间：调度控制 -->
                                    <div class="col-xl-6">
                                        <div class="card">
                                            <div class="card-header bg-transparent border-bottom d-flex justify-content-between align-items-center">
                                                <h5 class="card-title mb-0">调度控制</h5>
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-primary btn-sm active">实时监控</button>
                                                    <button type="button" class="btn btn-light btn-sm">调度计划</button>
                                                    <button type="button" class="btn btn-light btn-sm">应急控制</button>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <!-- 实时监控视图 -->
                                                <div class="monitoring-view">
                                                    <!-- 功率曲线图 -->
                                                    <div class="mb-4">
                                                        <div id="power-curve-chart" style="height: 300px;"></div>
                                                    </div>

                                                    <!-- 发电控制面板 -->
                                                    <div class="row">
                                                        <!-- 风电控制 -->
                                                        <div class="col-md-6">
                                                            <div class="card bg-soft-primary mb-3">
                                                                <div class="card-header">
                                                                    <h6 class="mb-0">风电控制</h6>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="d-flex align-items-center mb-3">
                                                                        <div class="flex-grow-1">
                                                                            <h6 class="mb-1">当前功率</h6>
                                                                            <h4 class="mb-0"><span data-generation-type="wind" data-power-value>320.5</span> MW</h4>
                                                                        </div>
                                                                        <div class="flex-shrink-0">
                                                                            <div class="btn-group">
                                                                                <button class="btn btn-sm btn-primary" data-generation-control data-generation-type="wind" data-generation-action="increase">
                                                                                    <i class="fas fa-plus"></i>
                                                                                </button>
                                                                                <button class="btn btn-sm btn-primary" data-generation-control data-generation-type="wind" data-generation-action="decrease">
                                                                                    <i class="fas fa-minus"></i>
                                                                                </button>
                                                                        </div>
                                                                    </div>
                                                                        </div>
                                                                    <div class="progress mb-2" style="height: 6px;">
                                                                        <div class="progress-bar" role="progressbar" style="width: 65%"></div>
                                                                    </div>
                                                                    <div class="d-flex justify-content-between">
                                                                        <small class="text-muted">利用率: 65%</small>
                                                                        <small class="text-muted">可用容量: 450MW</small>
                                                                    </div>
                                                                    <div class="mt-3">
                                                                        <button class="btn btn-sm btn-outline-primary me-2" data-generation-control data-generation-type="wind" data-generation-action="optimize">
                                                                            <i class="fas fa-magic me-1"></i>优化配置
                                                                        </button>
                                                                        <button class="btn btn-sm btn-outline-danger" data-generation-control data-generation-type="wind" data-generation-action="emergency">
                                                                            <i class="fas fa-exclamation-triangle me-1"></i>紧急停机
                                                                        </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        </div>

                                                        <!-- 光伏控制 -->
                                                        <div class="col-md-6">
                                                            <div class="card bg-soft-success mb-3">
                                                                <div class="card-header">
                                                                    <h6 class="mb-0">光伏控制</h6>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="d-flex align-items-center mb-3">
                                                                        <div class="flex-grow-1">
                                                                            <h6 class="mb-1">当前功率</h6>
                                                                            <h4 class="mb-0"><span data-generation-type="solar" data-power-value>425.8</span> MW</h4>
                                                                        </div>
                                                                        <div class="flex-shrink-0">
                                                                            <div class="btn-group">
                                                                                <button class="btn btn-sm btn-success" data-generation-control data-generation-type="solar" data-generation-action="increase">
                                                                                    <i class="fas fa-plus"></i>
                                                                                </button>
                                                                                <button class="btn btn-sm btn-success" data-generation-control data-generation-type="solar" data-generation-action="decrease">
                                                                                    <i class="fas fa-minus"></i>
                                                                                </button>
                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                    <div class="progress mb-2" style="height: 6px;">
                                                                            <div class="progress-bar bg-success" style="width: 85%"></div>
                                                                        </div>
                                                                    <div class="d-flex justify-content-between">
                                                                        <small class="text-muted">利用率: 85%</small>
                                                                        <small class="text-muted">可用容量: 520MW</small>
                                                                    </div>
                                                                    <div class="mt-3">
                                                                        <button class="btn btn-sm btn-outline-success me-2" data-generation-control data-generation-type="solar" data-generation-action="optimize">
                                                                            <i class="fas fa-magic me-1"></i>优化配置
                                                                        </button>
                                                                        <button class="btn btn-sm btn-outline-danger" data-generation-control data-generation-type="solar" data-generation-action="emergency">
                                                                            <i class="fas fa-exclamation-triangle me-1"></i>紧急停机
                                                                        </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        </div>

                                                        <!-- 储能控制 -->
                                                        <div class="col-md-6">
                                                            <div class="card bg-soft-warning mb-3">
                                                                <div class="card-header">
                                                                    <h6 class="mb-0">储能控制</h6>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="d-flex align-items-center mb-3">
                                                                        <div class="flex-grow-1">
                                                                            <h6 class="mb-1">当前储能</h6>
                                                                            <h4 class="mb-0"><span data-storage-value>110.0</span> MWh</h4>
                                                                        </div>
                                                                        <div class="flex-shrink-0">
                                                                            <div class="btn-group">
                                                                                <button class="btn btn-sm btn-warning" data-storage-control data-storage-action="charge">
                                                                                    <i class="fas fa-battery-quarter me-1"></i>充电
                                                                                </button>
                                                                                <button class="btn btn-sm btn-warning" data-storage-control data-storage-action="discharge">
                                                                                    <i class="fas fa-battery-three-quarters me-1"></i>放电
                                                                                </button>
                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                    <div class="progress mb-2" style="height: 6px;">
                                                                            <div class="progress-bar bg-warning" style="width: 55%"></div>
                                                                        </div>
                                                                    <div class="d-flex justify-content-between">
                                                                        <small class="text-muted">SOC: 55%</small>
                                                                        <small class="text-muted">总容量: 200MWh</small>
                                                                    </div>
                                                                    <div class="mt-3">
                                                                        <button class="btn btn-sm btn-outline-warning me-2" data-storage-control data-storage-action="optimize">
                                                                            <i class="fas fa-magic me-1"></i>优化配置
                                                                        </button>
                                                                        <button class="btn btn-sm btn-outline-secondary" data-storage-control data-storage-action="standby">
                                                                            <i class="fas fa-pause me-1"></i>待机模式
                                                                        </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        </div>

                                                        <!-- 负荷控制 -->
                                                        <div class="col-md-6">
                                                            <div class="card bg-soft-info mb-3">
                                                                <div class="card-header">
                                                                    <h6 class="mb-0">负荷控制</h6>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="d-flex align-items-center mb-3">
                                                                        <div class="flex-grow-1">
                                                                            <h6 class="mb-1">当前负荷</h6>
                                                                            <h4 class="mb-0"><span data-load-value>856.3</span> MW</h4>
                                                                        </div>
                                                                        <div class="flex-shrink-0">
                                                                            <div class="btn-group">
                                                                                <button class="btn btn-sm btn-info" data-load-control data-load-action="shed">
                                                                                    <i class="fas fa-power-off me-1"></i>切除
                                                                                </button>
                                                                                <button class="btn btn-sm btn-info" data-load-control data-load-action="limit">
                                                                                    <i class="fas fa-compress-arrows-alt me-1"></i>限制
                                                                                </button>
                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                    <div class="progress mb-2" style="height: 6px;">
                                                                            <div class="progress-bar bg-info" style="width: 75%"></div>
                                                                        </div>
                                                                    <div class="d-flex justify-content-between">
                                                                        <small class="text-muted">负载率: 75%</small>
                                                                        <small class="text-muted">峰值负荷: 1000MW</small>
                                                                    </div>
                                                                    <div class="mt-3">
                                                                        <button class="btn btn-sm btn-outline-info me-2" data-load-control data-load-action="optimize">
                                                                            <i class="fas fa-magic me-1"></i>优化配置
                                                                        </button>
                                                                        <button class="btn btn-sm btn-outline-success" data-load-control data-load-action="restore">
                                                                            <i class="fas fa-redo me-1"></i>恢复负荷
                                                                        </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                    <!-- 系统状态监控 -->
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="card">
                                                                <div class="card-header">
                                                                    <h6 class="mb-0">系统状态监控</h6>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="row">
                                                                        <div class="col-md-3">
                                                                            <div class="status-item">
                                                                                <h6 class="text-muted mb-1">系统频率</h6>
                                                                                <h4 class="mb-0"><span data-grid-frequency>50.02</span> Hz</h4>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-3">
                                                                            <div class="status-item">
                                                                                <h6 class="text-muted mb-1">功率因数</h6>
                                                                                <h4 class="mb-0"><span data-power-factor>0.95</span></h4>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-3">
                                                                            <div class="status-item">
                                                                                <h6 class="text-muted mb-1">线损率</h6>
                                                                                <h4 class="mb-0"><span data-line-loss>12.5</span>%</h4>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-3">
                                                                            <div class="status-item">
                                                                                <h6 class="text-muted mb-1">系统状态</h6>
                                                                                <h4 class="mb-0">
                                                                                    <span class="text-success">
                                                                                        <i class="fas fa-check-circle me-1"></i>正常
                                                                                    </span>
                                                                                </h4>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 右侧：调度指令 -->
                                    <div class="col-xl-3">
                                        <!-- 原有的调度指令卡片 -->
                                        <div class="card mb-4">
                                            <div class="card-header bg-transparent border-bottom">
                                                <div class="d-flex justify-content-between align-items-center">
                                                <h5 class="card-title mb-0">调度指令</h5>
                                                    <button class="btn btn-primary btn-sm" id="newCommandBtn">
                                                        <i class="ri-add-line align-middle me-1"></i>新建指令
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <!-- 快速调度 -->
                                                <div class="mb-4">
                                                    <h6 class="card-subtitle mb-3">快速调度</h6>
                                                    <div class="quick-dispatch">
                                                        <div class="row g-2">
                                                            <div class="col-6">
                                                                <button class="btn btn-soft-primary w-100" data-dispatch-type="wind">
                                                                    <i class="fas fa-wind me-1"></i>风电调节
                                                                </button>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn btn-soft-success w-100" data-dispatch-type="solar">
                                                                    <i class="fas fa-sun me-1"></i>光伏调节
                                                                </button>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn btn-soft-warning w-100" data-dispatch-type="storage">
                                                                    <i class="fas fa-battery-half me-1"></i>储能控制
                                                                </button>
                                                            </div>
                                                            <div class="col-6">
                                                                <button class="btn btn-soft-info w-100" data-dispatch-type="load">
                                                                    <i class="fas fa-plug me-1"></i>负荷管理
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 最近指令 -->
                                                <div class="mb-4">
                                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                                        <h6 class="card-subtitle mb-0">最近指令</h6>
                                                        <div class="btn-group btn-group-sm">
                                                            <button class="btn btn-light active" data-view="all">全部</button>
                                                            <button class="btn btn-light" data-view="pending">待执行</button>
                                                            <button class="btn btn-light" data-view="executing">执行中</button>
                                                        </div>
                                                    </div>
                                                    <div class="recent-commands">
                                                        <!-- 由JS动态生成内容 -->
                                                    </div>
                                                </div>

                                                <!-- 应急按钮 -->
                                                <div>
                                                    <button class="btn btn-danger w-100" data-bs-toggle="modal" data-bs-target="#emergencyControlModal">
                                                        <i class="fas fa-exclamation-triangle me-1"></i>应急控制
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        

                                        <!-- 调度效果分析 -->
                                        <div class="card mb-4">
                                            <div class="card-header bg-transparent border-bottom">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">调度效果分析</h5>
                                                    <!-- <div class="dropdown">
                                                        <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                                            今日 <i class="mdi mdi-chevron-down"></i>
                                                        </button>
                                                        <div class="dropdown-menu">
                                                            <a class="dropdown-item" href="#">今日</a>
                                                            <a class="dropdown-item" href="#">本周</a>
                                                            <a class="dropdown-item" href="#">本月</a>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <!-- 调度指标 -->
                                                <div class="row g-0 text-center mb-4">
                                                    <div class="col-4">
                                                        <div class="p-3">
                                                            <h4 class="mb-1" id="executionRate">98.5%</h4>
                                                            <p class="text-muted mb-0">指令执行率</p>
                                                        </div>
                                                    </div>
                                                    <div class="col-4">
                                                        <div class="p-3">
                                                            <h4 class="mb-1" id="responseTime">1.2s</h4>
                                                            <p class="text-muted mb-0">平均响应时间</p>
                                                        </div>
                                                    </div>
                                                    <div class="col-4">
                                                        <div class="p-3">
                                                            <h4 class="mb-1" id="accuracy">96.8%</h4>
                                                            <p class="text-muted mb-0">调度准确率</p>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- <div class="dispatch-effect-chart" style="height: 200px;">
                                                </div> -->

                                                <!-- 优化建议 -->
                                                <div class="optimization-suggestions mt-4">
                                                    <h6 class="text-muted mb-3">优化建议</h6>
                                                    <div class="suggestion-item d-flex align-items-start mb-2">
                                                            <div class="flex-shrink-0">
                                                            <i class="ri-lightbulb-line text-warning fs-18"></i>
                                                            </div>
                                                        <div class="flex-grow-1 ms-2">
                                                            <p class="mb-0">建议在14:00-16:00期间增加储能放电功率，优化峰谷差</p>
                                                            </div>
                                                        </div>
                                                    <div class="suggestion-item d-flex align-items-start">
                                                            <div class="flex-shrink-0">
                                                            <i class="ri-lightbulb-line text-warning fs-18"></i>
                                                        </div>
                                                        <div class="flex-grow-1 ms-2">
                                                            <p class="mb-0">风电功率波动较大，建议启用自动优化策略</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 调度预警 -->
                                        <div class="card">
                                            <div class="card-header bg-transparent border-bottom">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">调度预警</h5>
                                                    <button class="btn btn-light btn-sm" onclick="powerDispatchCommands.acknowledgeAllAlerts()">
                                                        <i class="ri-check-double-line"></i> 全部确认
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="dispatch-alerts" style="height: 350px;" data-simplebar>
                                                    <div class="alert alert-warning m-3">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0">
                                                                <i class="ri-error-warning-line fs-24"></i>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">功率波动预警</h6>
                                                                <p class="mb-0">风机组#3功率波动超过阈值，建议检查</p>
                                                                <small class="text-muted">5分钟前</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <button class="btn btn-sm btn-light" onclick="powerDispatchCommands.acknowledgeAlert('alert1')">
                                                                    <i class="ri-check-line"></i>
                                                                </button>
                                                        </div>
                                                        </div>
                                                    </div>
                                                    <div class="alert alert-info m-3">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0">
                                                                <i class="ri-information-line fs-24"></i>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">调度建议</h6>
                                                                <p class="mb-0">当前光照条件良好，建议提高光伏出力</p>
                                                                <small class="text-muted">10分钟前</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <button class="btn btn-sm btn-light" onclick="powerDispatchCommands.acknowledgeAlert('alert2')">
                                                                    <i class="ri-check-line"></i>
                                                                </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div class="alert alert-danger m-3">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0">
                                                                <i class="ri-alarm-warning-line fs-24"></i>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">储能SOC预警</h6>
                                                                <p class="mb-0">储能单元#2 SOC低于20%，建议及时充电</p>
                                                                <small class="text-muted">15分钟前</small>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <button class="btn btn-sm btn-light" onclick="powerDispatchCommands.acknowledgeAlert('alert3')">
                                                                    <i class="ri-check-line"></i>
                                                    </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 底部：调度计划和历史记录 -->
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="card">
                                            <div class="card-header bg-transparent border-bottom">
                                                <div class="d-flex align-items-center">
                                                    <h5 class="card-title mb-0 flex-grow-1">调度计划</h5>
                                                    <div class="flex-shrink-0">
                                                        <button class="btn btn-primary btn-sm">
                                                            <i class="fas fa-plus me-1"></i>新建计划
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead>
                                                            <tr>
                                                                <th>计划ID</th>
                                                                <th>类型</th>
                                                                <th>目标</th>
                                                                <th>执行时间</th>
                                                                <th>状态</th>
                                                                <th>操作</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>PLAN20240326001</td>
                                                                <td>功率调整</td>
                                                                <td>风机组#1-5</td>
                                                                <td>2024-03-26 15:00</td>
                                                                <td><span class="badge bg-info">待执行</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326002</td>
                                                                <td>储能调度</td>
                                                                <td>储能站#2</td>
                                                                <td>2024-03-26 16:00</td>
                                                                <td><span class="badge bg-info">待执行</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326003</td>
                                                                <td>负载管理</td>
                                                                <td>高新区配电站</td>
                                                                <td>2024-03-26 16:30</td>
                                                                <td><span class="badge bg-warning">执行中</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-warning">暂停</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326004</td>
                                                                <td>光伏调节</td>
                                                                <td>光伏阵列A区</td>
                                                                <td>2024-03-26 17:00</td>
                                                                <td><span class="badge bg-info">待执行</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326005</td>
                                                                <td>削峰填谷</td>
                                                                <td>储能站群组</td>
                                                                <td>2024-03-26 18:00</td>
                                                                <td><span class="badge bg-primary">已安排</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326006</td>
                                                                <td>调频服务</td>
                                                                <td>风机组#6-10</td>
                                                                <td>2024-03-26 15:30</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-info">报告</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326007</td>
                                                                <td>紧急调度</td>
                                                                <td>全网设备</td>
                                                                <td>2024-03-26 14:45</td>
                                                                <td><span class="badge bg-success">已完成</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-info">报告</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326008</td>
                                                                <td>功率优化</td>
                                                                <td>光伏阵列B区</td>
                                                                <td>2024-03-26 19:00</td>
                                                                <td><span class="badge bg-secondary">已排期</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326009</td>
                                                                <td>需求响应</td>
                                                                <td>工业园区</td>
                                                                <td>2024-03-26 20:00</td>
                                                                <td><span class="badge bg-info">待执行</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>PLAN20240326010</td>
                                                                <td>备用启动</td>
                                                                <td>应急发电机组</td>
                                                                <td>2024-03-26 21:00</td>
                                                                <td><span class="badge bg-secondary">已排期</span></td>
                                                                <td>
                                                                    <div class="d-flex gap-2">
                                                                        <button class="btn btn-sm btn-soft-primary">详情</button>
                                                                        <button class="btn btn-sm btn-soft-danger">取消</button>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div class="col-xl-4">
                                        <div class="card">
                                            <div class="card-header bg-transparent border-bottom">
                                                <h5 class="card-title mb-0">执行历史</h5>
                                            </div>
                                            <div class="card-body">
                                                <div data-simplebar style="max-height: 300px;">
                                                    <div class="activity-timeline">
                                                        <div class="d-flex align-items-start">
                                                            <div class="flex-shrink-0">
                                                                <div class="avatar-xs">
                                                                    <div class="avatar-title rounded-circle bg-soft-success text-success">
                                                                        <i class="fas fa-check"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">风机组#5功率调整完成</h6>
                                                                <p class="text-muted mb-0">10:30 - 功率已调整至250MW</p>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <small class="text-muted">5分钟前</small>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-start mt-3">
                                                            <div class="flex-shrink-0">
                                                                <div class="avatar-xs">
                                                                    <div class="avatar-title rounded-circle bg-soft-primary text-primary">
                                                                        <i class="fas fa-sync"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">光伏阵列角度调整</h6>
                                                                <p class="text-muted mb-0">10:15 - 角度已调整至32°</p>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <small class="text-muted">20分钟前</small>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-start mt-3">
                                                            <div class="flex-shrink-0">
                                                                <div class="avatar-xs">
                                                                    <div class="avatar-title rounded-circle bg-soft-warning text-warning">
                                                                        <i class="fas fa-battery-half"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h6 class="mb-1">储能系统充电开始</h6>
                                                                <p class="text-muted mb-0">10:00 - 充电功率50MW</p>
                                                            </div>
                                                            <div class="flex-shrink-0">
                                                                <small class="text-muted">35分钟前</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>
                            </div>

                            <!-- 能源交易执行页面 -->
                            <div class="tab-pane" id="energy-trading" role="tabpanel">
                                <!-- 能源交易执行界面 -->
                                <div class="trading-execution-section">
                                    <!-- 顶部市场概览 -->
                                    <div class="market-overview">
                                        <div class="row g-3">
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card market-card">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between">
                                                            <div>
                                                                <p class="text-muted mb-1">实时电价</p>
                                                                <h3 class="mb-0">¥486.75</h3>
                                                            </div>
                                                            <div class="price-trend up">
                                                                +2.8%
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card market-card">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between">
                                                            <div>
                                                                <p class="text-muted mb-1">当日交易量</p>
                                                                <h3 class="mb-0">2,580 MWh</h3>
                                                            </div>
                                                            <div class="mini-chart">
                                                                <div id="trading-volume-spark"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card market-card">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between">
                                                            <div>
                                                                <p class="text-muted mb-1">预计收益</p>
                                                                <h3 class="mb-0">¥158,900</h3>
                                                            </div>
                                                            <div class="mini-chart">
                                                                <div id="profit-forecast-spark"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card market-card">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between">
                                                            <div>
                                                                <p class="text-muted mb-1">策略执行率</p>
                                                                <h3 class="mb-0">96.8%</h3>
                                                            </div>
                                                            <div class="status-icon success">
                                                                <i class="ri-check-line"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 主要交易区域 -->
                                    <div class="row mt-4">
                                        <!-- 左侧 - 市场行情 -->
                                        <div class="col-xl-8">
                                            <div class="card">
                                                <div class="card-body p-0">
                                                    <!-- 市场行情头部 -->
                                                    <div class="trading-header">
                                                        <div class="d-flex justify-content-between align-items-center p-3">
                                                            <div class="market-info">
                                                                <h4 class="mb-1">现货市场行情</h4>
                                                                <div class="price-stats">
                                                                    <span class="current-price">¥486.75</span>
                                                                    <span class="price-change up">+¥15.8 (+2.8%)</span>
                                                                </div>
                                                            </div>
                                                            <div class="chart-controls">
                                                                <div class="btn-group" role="group">
                                                                    <button type="button" class="btn btn-dark-light active" onclick="updateChartPeriod('1D')">24H</button>
                                                                    <button type="button" class="btn btn-dark-light" onclick="updateChartPeriod('7D')">7D</button>
                                                                    <button type="button" class="btn btn-dark-light" onclick="updateChartPeriod('1M')">30D</button>
                                                                    <button type="button" class="btn btn-dark-light" onclick="updateChartPeriod('ALL')">ALL</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="market-stats px-3 pb-3">
                                                            <div class="row g-0">
                                                                <div class="col-4">
                                                                    <div class="stat-item">
                                                                        <label>日最高</label>
                                                                        <span class="value">¥489.70</span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-4">
                                                                    <div class="stat-item">
                                                                        <label>日最低</label>
                                                                        <span class="value">¥475.30</span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-4">
                                                                    <div class="stat-item">
                                                                        <label>24H成交量</label>
                                                                        <span class="value">8,245 MWh</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- 交易图表 -->
                                                    <div class="trading-chart-container">
                                                        <div id="tradingChart" style="height: 400px;"></div>
                                                        <!-- <div id="volumeChart" style="height: 100px;"></div> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 右侧 - 交易面板 -->
                                        <div class="col-xl-4">
                                            <div class="card">
                                                <div class="card-body">
                                                    <div class="trading-panel">
                                                        <!-- 交易类型选择 -->
                                                        <div class="trading-type-selector mb-4">
                                                            <h5 class="trading-panel-title">交易类型</h5>
                                                            <div class="btn-group w-100" role="group">
                                                                <input type="radio" class="btn-check" name="trading-type" id="spot-trading" value="spot" checked>
                                                                <label class="btn btn-outline-primary" for="spot-trading" data-type="spot">
                                                                    <i class="fas fa-bolt me-1"></i>现货交易
                                                                </label>
                                                                
                                                                <input type="radio" class="btn-check" name="trading-type" id="contract-trading" value="contract">
                                                                <label class="btn btn-outline-primary" for="contract-trading" data-type="contract">
                                                                    <i class="fas fa-file-contract me-1"></i>合约交易
                                                                </label>
                                                                
                                                                <input type="radio" class="btn-check" name="trading-type" id="auxiliary-service" value="auxiliary">
                                                                <label class="btn btn-outline-primary" for="auxiliary-service" data-type="auxiliary">
                                                                    <i class="fas fa-cogs me-1"></i>辅助服务
                                                                </label>
                                                            </div>
                                                        </div>

                                                        <!-- 交易方向 -->
                                                        <div class="trading-direction mb-4">
                                                            <h5 class="trading-panel-title">交易方向</h5>
                                                            <div class="d-flex gap-2">
                                                                <button type="button" class="btn btn-success flex-fill" data-direction="buy" id="buyButton">
                                                                    <i class="fas fa-arrow-up me-1"></i>买入
                                                                </button>
                                                                <button type="button" class="btn btn-outline-danger flex-fill" data-direction="sell" id="sellButton">
                                                                    <i class="fas fa-arrow-down me-1"></i>卖出
                                                                </button>
                                                            </div>
                                                        </div>

                                                        <!-- 交易表单 -->
                                                        <form class="trading-form" id="tradingForm">
                                                            <div class="mb-3">
                                                                <label class="form-label">交易电量 (MWh)</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="powerAmount" placeholder="输入交易电量" min="0">
                                                                    <div class="btn-group">
                                                                        <button type="button" class="btn btn-outline-secondary" data-amount="25">25%</button>
                                                                        <button type="button" class="btn btn-outline-secondary" data-amount="50">50%</button>
                                                                        <button type="button" class="btn btn-outline-secondary" data-amount="75">75%</button>
                                                                        <button type="button" class="btn btn-outline-secondary" data-amount="100">100%</button>
                                                                    </div>
                                                                </div>
                                                                <small class="text-muted" id="maxAmount">最大可交易量: 1000 MWh</small>
                                                            </div>

                                                            <div class="mb-3" id="priceInputGroup">
                                                                <label class="form-label">交易价格 (元/MWh)</label>
                                                                <div class="input-group">
                                                                    <span class="input-group-text">¥</span>
                                                                    <input type="number" class="form-control" id="powerPrice" placeholder="输入交易价格" min="0">
                                                                </div>
                                                                <small class="text-muted">当前市场价: ¥<span id="currentMarketPrice">480.00</span></small>
                                                            </div>

                                                            <div class="mb-3">
                                                                <label class="form-label">交易时段</label>
                                                                <select class="form-select" id="tradingPeriod">
                                                                    <option value="peak" data-time="08:00-21:00">峰时段 (08:00-21:00)</option>
                                                                    <option value="flat" data-time="21:00-24:00">平时段 (21:00-24:00)</option>
                                                                    <option value="valley" data-time="00:00-08:00">谷时段 (00:00-08:00)</option>
                                                                </select>
                                                            </div>

                                                            <div class="mb-4">
                                                                <label class="form-label">预估交易金额</label>
                                                                <div class="estimate-amount">
                                                                    <span class="currency">¥</span>
                                                                    <span class="amount" id="estimatedAmount">0.00</span>
                                                                </div>
                                                            </div>

                                                            <button type="submit" class="btn btn-primary w-100 btn-lg" id="confirmTradeBtn">
                                                                确认交易
                                                            </button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 底部区域 -->
                                    <div class="row mt-4">
                                        <!-- 左侧 - 交易策略 -->
                                        <div class="col-xl-4">
                                            <div class="card">
                                                <div class="card-header">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <h5 class="mb-0">交易策略</h5>
                                                        <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#newStrategyModal">
                                                            <i class="ri-add-line align-middle"></i> 新建策略
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="card-body p-0">
                                                    <div class="strategy-list">
                                                        <div class="strategy-item">
                                                            <div class="strategy-info">
                                                                <h6>峰谷套利策略</h6>
                                                                <p>谷时段买入，峰时段卖出，利用电价差进行套利</p>
                                                                <div class="strategy-meta">
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-line-chart-line"></i>
                                                                        <span>收益率: +15.8%</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-time-line"></i>
                                                                        <span>运行时间: 30天</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-exchange-funds-line"></i>
                                                                        <span>成交次数: 128次</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="strategy-actions">
                                                                <div class="strategy-status active">运行中</div>
                                                                <button type="button" class="strategy-config-btn" data-bs-toggle="modal" data-bs-target="#strategyConfigModal">
                                                                    <i class="ri-settings-3-line"></i>
                                                                </button>
                                                            </div>
                                                        </div>

                                                        <div class="strategy-item">
                                                            <div class="strategy-info">
                                                                <h6>价差套利策略</h6>
                                                                <p>跨市场价差大于5%时进行套利交易</p>
                                                                <div class="strategy-meta">
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-line-chart-line"></i>
                                                                        <span>收益率: +8.3%</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-time-line"></i>
                                                                        <span>运行时间: 15天</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-exchange-funds-line"></i>
                                                                        <span>成交次数: 45次</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="strategy-actions">
                                                                <div class="strategy-status inactive">已暂停</div>
                                                                <button type="button" class="strategy-config-btn" data-bs-toggle="modal" data-bs-target="#strategyConfigModal">
                                                                    <i class="ri-settings-3-line"></i>
                                                                </button>
                                                            </div>
                                                        </div>

                                                        <div class="strategy-item">
                                                            <div class="strategy-info">
                                                                <h6>调频辅助服务策略</h6>
                                                                <p>根据系统调频需求自动响应并提供辅助服务</p>
                                                                <div class="strategy-meta">
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-line-chart-line"></i>
                                                                        <span>收益率: +12.5%</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-time-line"></i>
                                                                        <span>运行时间: 7天</span>
                                                                    </div>
                                                                    <div class="strategy-meta-item">
                                                                        <i class="ri-exchange-funds-line"></i>
                                                                        <span>成交次数: 86次</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="strategy-actions">
                                                                <div class="strategy-status testing">测试中</div>
                                                                <button type="button" class="strategy-config-btn" data-bs-toggle="modal" data-bs-target="#strategyConfigModal">
                                                                    <i class="ri-settings-3-line"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 策略配置模态框 -->
                                            <div class="modal fade strategy-config-modal" id="strategyConfigModal" tabindex="-1">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title">策略配置 - 峰谷套利策略</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="strategy-params">
                                                                <div class="strategy-param-group">
                                                                    <div class="strategy-param-label">
                                                                        <span>峰时段设置</span>
                                                                        <span class="param-info">设置电价较高的时段</span>
                                                                    </div>
                                                                    <div class="strategy-param-value">
                                                                        <input type="time" class="form-control" value="08:00">
                                                                        <span class="input-group-text">至</span>
                                                                        <input type="time" class="form-control" value="21:00">
                                                                    </div>
                                                                </div>

                                                                <div class="strategy-param-group">
                                                                    <div class="strategy-param-label">
                                                                        <span>最小价差</span>
                                                                        <span class="param-info">触发交易的最小价格差</span>
                                                                    </div>
                                                                    <div class="strategy-param-value">
                                                                        <div class="input-group">
                                                                            <input type="number" class="form-control" value="50">
                                                                            <span class="input-group-text">元/MWh</span>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="strategy-param-group">
                                                                    <div class="strategy-param-label">
                                                                        <span>单次交易量</span>
                                                                        <span class="param-info">每次交易的最大电量</span>
                                                                    </div>
                                                                    <div class="strategy-param-value">
                                                                        <div class="input-group">
                                                                            <input type="number" class="form-control" value="200">
                                                                            <span class="input-group-text">MWh</span>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="strategy-param-group">
                                                                    <div class="strategy-param-label">
                                                                        <span>止盈止损</span>
                                                                        <span class="param-info">设置盈亏平仓点</span>
                                                                    </div>
                                                                    <div class="strategy-param-value">
                                                                        <div class="input-group">
                                                                            <span class="input-group-text">止盈</span>
                                                                            <input type="number" class="form-control" value="8">
                                                                            <span class="input-group-text">%</span>
                                                                        </div>
                                                                        <div class="input-group">
                                                                            <span class="input-group-text">止损</span>
                                                                            <input type="number" class="form-control" value="3">
                                                                            <span class="input-group-text">%</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="strategy-performance">
                                                                <div class="performance-card">
                                                                    <label>累计收益</label>
                                                                    <div class="value">
                                                                        ¥158,900
                                                                        <span class="trend up">+15.8%</span>
                                                                    </div>
                                                                </div>
                                                                <div class="performance-card">
                                                                    <label>胜率</label>
                                                                    <div class="value">
                                                                        85.5%
                                                                        <span class="trend up">+2.3%</span>
                                                                    </div>
                                                                </div>
                                                                <div class="performance-card">
                                                                    <label>最大回撤</label>
                                                                    <div class="value">
                                                                        4.2%
                                                                        <span class="trend down">+0.5%</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-light" data-bs-dismiss="modal">取消</button>
                                                            <button type="button" class="btn btn-primary">保存配置</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 新建策略模态框 -->
                                            <div class="modal fade" id="newStrategyModal" tabindex="-1">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title">新建交易策略</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="mb-3">
                                                                <label class="form-label">策略名称</label>
                                                                <input type="text" class="form-control" placeholder="输入策略名称">
                                                            </div>
                                                            <div class="mb-3">
                                                                <label class="form-label">策略类型</label>
                                                                <select class="form-select">
                                                                    <option value="time_arbitrage">时间套利</option>
                                                                    <option value="price_arbitrage">价差套利</option>
                                                                    <option value="auxiliary">辅助服务</option>
                                                                    <option value="custom">自定义策略</option>
                                                                </select>
                                                            </div>
                                                            <div class="mb-3">
                                                                <label class="form-label">策略描述</label>
                                                                <textarea class="form-control" rows="3" placeholder="描述策略的主要功能和特点"></textarea>
                                                            </div>
                                                            <div class="mb-3">
                                                                <label class="form-label">初始资金</label>
                                                                <div class="input-group">
                                                                    <span class="input-group-text">¥</span>
                                                                    <input type="number" class="form-control" placeholder="输入初始资金">
                                                                </div>
                                                            </div>
                                                            <div class="mb-3">
                                                                <label class="form-label">风险等级</label>
                                                                <select class="form-select">
                                                                    <option value="low">低风险</option>
                                                                    <option value="medium">中等风险</option>
                                                                    <option value="high">高风险</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-light" data-bs-dismiss="modal">取消</button>
                                                            <button type="button" class="btn btn-primary">创建策略</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 右侧 - 成交记录 -->
                                        <div class="col-xl-8">
                                            <div class="card">
                                                <div class="card-header">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <h5 class="mb-0">成交记录</h5>
                                                        <div class="d-flex gap-2">
                                                            <button type="button" class="btn btn-light btn-sm">
                                                                <i class="ri-filter-3-line align-middle"></i> 筛选
                                                            </button>
                                                            <button type="button" class="btn btn-light btn-sm">
                                                                <i class="ri-download-2-line align-middle"></i> 导出
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="card-body p-0">
                                                    <div class="table-responsive">
                                                        <table class="table table-trading align-middle mb-0">
                                                            <thead>
                                                                <tr>
                                                                    <th>交易ID</th>
                                                                    <th>类型</th>
                                                                    <th>方向</th>
                                                                    <th>价格</th>
                                                                    <th>电量</th>
                                                                    <th>金额</th>
                                                                    <th>状态</th>
                                                                    <th>操作</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>TRD-2024032601</td>
                                                                    <td>现货交易</td>
                                                                    <td><span class="text-success">买入</span></td>
                                                                    <td>¥475.50</td>
                                                                    <td>100 MWh</td>
                                                                    <td>¥47,550.00</td>
                                                                    <td><span class="badge bg-success">已成交</span></td>
                                                                    <td>
                                                                        <button type="button" class="btn btn-sm btn-light">详情</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TRD-2024032602</td>
                                                                    <td>现货交易</td>
                                                                    <td><span class="text-danger">卖出</span></td>
                                                                    <td>¥486.75</td>
                                                                    <td>150 MWh</td>
                                                                    <td>¥73,012.50</td>
                                                                    <td><span class="badge bg-warning">待确认</span></td>
                                                                    <td>
                                                                        <button type="button" class="btn btn-sm btn-light">详情</button>
                                                                        <button type="button" class="btn btn-sm btn-danger">撤销</button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 设备检修管理页面 -->
                            <div class="tab-pane" id="equipment-maintenance" role="tabpanel">
                                <!-- 添加调试按钮 -->
                                <div class="row mb-3">
                                    <div class="col-12">
                                        <!-- <button id="debugMaintenanceBtn" class="btn btn-secondary" onclick="debugMaintenance()">
                                            调试检修管理
                                        </button> -->
                                    </div>
                                </div>
                                
                                <!-- 顶部状态栏 -->
                                <div class="row mb-3">
                                    <div class="col-xl-12">
                                        <div class="card bg-primary">
                                            <div class="card-body p-2">
                                                <div class="row align-items-center">
                                                    <div class="col-sm-6">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-shrink-0">
                                                                <div class="avatar-md">
                                                                    <div class="avatar-title bg-soft-light text-light rounded-circle fs-2">
                                                                        <i class="fas fa-tools"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="flex-grow-1 ms-3">
                                                                <h4 class="text-white mb-1">设备检修管理中心</h4>
                                                                <p class="text-white-50 mb-0">设备维护 | 检修计划 | 故障处理</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="row text-end">
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">设备总数</div>
                                                                <h5 class="text-white mb-0">128 台</h5>
                                                            </div>
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">健康度</div>
                                                                <h5 class="text-white mb-0">96.8%</h5>
                                                            </div>
                                                            <div class="col-4">
                                                                <div class="text-white-50 fs-13">系统状态</div>
                                                                <h5 class="text-white mb-0"><i class="fas fa-circle text-success me-1"></i>正常</h5>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 检修看板 -->
                                <div class="maintenance-dashboard mb-4">
                                    <!-- 由JS动态生成内容 -->
                                </div>

                                <!-- 主要内容区域 -->
                                <div class="row">
                                    <!-- 左侧：设备状态概览 -->
                                    <div class="col-xl-3">
                                        <!-- 设备状态概览 -->
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">设备状态概览</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="equipment-overview">
                                                    <div class="equipment-status-card">
                                                        <div class="status-icon normal">
                                                            <i class="ri-checkbox-circle-line"></i>
                                                        </div>
                                                        <h4>正常运行</h4>
                                                        <h2>108</h2>
                                                        <div class="equipment-progress">
                                                            <div class="progress" style="height: 6px;">
                                                                <div class="progress-bar bg-success" style="width: 84.4%"></div>
                                                            </div>
                                                            <small class="text-muted">占比 84.4%</small>
                                                        </div>
                                                    </div>
                                                    <div class="equipment-status-card">
                                                        <div class="status-icon warning">
                                                            <i class="ri-error-warning-line"></i>
                                                        </div>
                                                        <h4>需要维护</h4>
                                                        <h2>15</h2>
                                                        <div class="equipment-progress">
                                                            <div class="progress" style="height: 6px;">
                                                                <div class="progress-bar bg-warning" style="width: 11.7%"></div>
                                                            </div>
                                                            <small class="text-muted">占比 11.7%</small>
                                                        </div>
                                                    </div>
                                                    <div class="equipment-status-card">
                                                        <div class="status-icon danger">
                                                            <i class="ri-alarm-warning-line"></i>
                                                        </div>
                                                        <h4>故障设备</h4>
                                                        <h2>5</h2>
                                                        <div class="equipment-progress">
                                                            <div class="progress" style="height: 6px;">
                                                                <div class="progress-bar bg-danger" style="width: 3.9%"></div>
                                                            </div>
                                                            <small class="text-muted">占比 3.9%</small>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 设备健康度图表 -->
                                                <div class="mt-4">
                                                    <h6 class="text-muted mb-3">设备健康度趋势</h6>
                                                    <div id="equipment-health-chart"></div>
                                                </div>

                                                <!-- 检修任务完成率 -->
                                                <div class="mt-4">
                                                    <h6 class="text-muted mb-3">检修任务完成率</h6>
                                                    <div id="task-completion-chart"></div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 检修日历 -->
                                        <div class="card">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0">检修计划日历</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="maintenance-calendar">
                                                    <!-- 由JS动态生成内容 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 中间：检修工单管理 -->
                                    <div class="col-xl-6">
                                        <!-- 工单管理 -->
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">检修工单管理</h5>
                                                    <div class="btn-group">
                                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newWorkOrderModal">
                                                        <i class="ri-add-line align-middle me-1"></i>新建工单
                                                    </button>
                                                        <button class="btn btn-light" onclick="maintenanceManagement.exportWorkOrders()">
                                                            <i class="ri-download-2-line align-middle me-1"></i>导出
                                                    </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <!-- 工单筛选器 -->
                                                <div class="work-order-filters mb-4">
                                                    <div class="row g-2">
                                                        <div class="col-md-3">
                                                            <select class="form-select" id="orderType">
                                                                <option value="all">全部类型</option>
                                                                <option value="routine">例行检修</option>
                                                                <option value="preventive">预防性检修</option>
                                                                <option value="corrective">故障检修</option>
                                                                <option value="predictive">预测性检修</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <select class="form-select" id="orderStatus">
                                                                <option value="all">全部状态</option>
                                                                <option value="pending">待处理</option>
                                                                <option value="in-progress">进行中</option>
                                                                <option value="completed">已完成</option>
                                                                <option value="cancelled">已取消</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <select class="form-select" id="orderPriority">
                                                                <option value="all">全部优先级</option>
                                                                <option value="high">高优先级</option>
                                                                <option value="medium">中优先级</option>
                                                                <option value="low">低优先级</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" placeholder="搜索工单..." id="orderSearch">
                                                                <button class="btn btn-outline-secondary" type="button">
                                                                    <i class="ri-search-line"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 工单列表 -->
                                                <div class="work-orders-table">
                                                    <div class="table-responsive">
                                                        <table class="table table-hover">
                                                            <thead>
                                                                <tr>
                                                                    <th>工单编号</th>
                                                                    <th>检修类型</th>
                                                                    <th>设备名称</th>
                                                                    <th>计划时间</th>
                                                                    <th>负责人</th>
                                                                    <th>状态</th>
                                                                    <th>操作</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>WO-20240401001</td>
                                                                    <td>例行检修</td>
                                                                    <td>主变压器#1</td>
                                                                    <td>2024-04-01 09:00</td>
                                                                    <td>张工</td>
                                                                    <td><span class="badge bg-warning">进行中</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401001')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401001')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401001')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401002</td>
                                                                    <td>故障检修</td>
                                                                    <td>储能系统#2</td>
                                                                    <td>2024-04-01 10:30</td>
                                                                    <td>李工</td>
                                                                    <td><span class="badge bg-danger">紧急</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401002')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401002')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401002')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                            </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401003</td>
                                                                    <td>预防性检修</td>
                                                                    <td>光伏组件A区</td>
                                                                    <td>2024-04-01 13:00</td>
                                                                    <td>王工</td>
                                                                    <td><span class="badge bg-info">待处理</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401003')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401003')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401003')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401004</td>
                                                                    <td>预测性检修</td>
                                                                    <td>风机组#5</td>
                                                                    <td>2024-04-01 14:30</td>
                                                                    <td>赵工</td>
                                                                    <td><span class="badge bg-primary">已安排</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401004')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401004')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401004')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401005</td>
                                                                    <td>例行检修</td>
                                                                    <td>配电柜#B3</td>
                                                                    <td>2024-04-01 15:00</td>
                                                                    <td>刘工</td>
                                                                    <td><span class="badge bg-success">已完成</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401005')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-secondary" onclick="maintenanceManagement.viewReport('WO-20240401005')">
                                                                                <i class="ri-file-list-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401006</td>
                                                                    <td>故障检修</td>
                                                                    <td>逆变器#2</td>
                                                                    <td>2024-04-01 16:00</td>
                                                                    <td>陈工</td>
                                                                    <td><span class="badge bg-warning">处理中</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401006')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401006')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401006')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401007</td>
                                                                    <td>预防性检修</td>
                                                                    <td>变压器#2</td>
                                                                    <td>2024-04-02 09:00</td>
                                                                    <td>杨工</td>
                                                                    <td><span class="badge bg-secondary">已排期</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401007')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401007')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401007')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401008</td>
                                                                    <td>预测性检修</td>
                                                                    <td>储能电池组#3</td>
                                                                    <td>2024-04-02 10:30</td>
                                                                    <td>周工</td>
                                                                    <td><span class="badge bg-info">待确认</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401008')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401008')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401008')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401009</td>
                                                                    <td>例行检修</td>
                                                                    <td>输电线路C段</td>
                                                                    <td>2024-04-02 13:00</td>
                                                                    <td>吴工</td>
                                                                    <td><span class="badge bg-warning">待审批</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401009')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401009')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401009')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>WO-20240401010</td>
                                                                    <td>故障检修</td>
                                                                    <td>监控系统</td>
                                                                    <td>2024-04-02 14:30</td>
                                                                    <td>郑工</td>
                                                                    <td><span class="badge bg-danger">待处理</span></td>
                                                                    <td>
                                                                        <div class="btn-group">
                                                                            <button class="btn btn-sm btn-info" onclick="maintenanceManagement.viewWorkOrder('WO-20240401010')">
                                                                                <i class="ri-eye-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-success" onclick="maintenanceManagement.updateWorkOrder('WO-20240401010')">
                                                                                <i class="ri-edit-line"></i>
                                                                            </button>
                                                                            <button class="btn btn-sm btn-danger" onclick="maintenanceManagement.cancelWorkOrder('WO-20240401010')">
                                                                                <i class="ri-close-line"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                        </div>
                                    </div>

                                        <!-- 工单详情卡片 -->
                                        <div class="card">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">工单详情 #WO-20240401001</h5>
                                                    <div class="btn-group">
                                                        <button class="btn btn-success" onclick="maintenanceManagement.startWorkOrder('WO-20240401001')">
                                                            <i class="ri-play-line me-1"></i>开始执行
                                                        </button>
                                                        <button class="btn btn-primary" onclick="maintenanceManagement.completeWorkOrder('WO-20240401001')">
                                                            <i class="ri-check-line me-1"></i>完成工单
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <!-- 基本信息 -->
                                                    <div class="col-md-6">
                                                        <div class="info-group">
                                                            <h6 class="mb-3">基本信息</h6>
                                                            <div class="info-item">
                                                                <label>检修类型:</label>
                                                                <span>例行检修</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>计划时间:</label>
                                                                <span>2024-04-01 09:00</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>预计时长:</label>
                                                                <span>4小时</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>负责人:</label>
                                                                <span>张工</span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- 设备信息 -->
                                                    <div class="col-md-6">
                                                        <div class="info-group">
                                                            <h6 class="mb-3">设备信息</h6>
                                                            <div class="info-item">
                                                                <label>设备名称:</label>
                                                                <span>主变压器#1</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>设备编号:</label>
                                                                <span>TRANS-001</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>运行时长:</label>
                                                                <span>3650天</span>
                                                            </div>
                                                            <div class="info-item">
                                                                <label>上次检修:</label>
                                                                <span>2024-01-15</span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- 检修项目 -->
                                                    <div class="col-12 mt-4">
                                                        <h6 class="mb-3">检修项目</h6>
                                                        <div class="table-responsive">
                                                            <table class="table table-sm">
                                                                <thead>
                                                                    <tr>
                                                                        <th>项目</th>
                                                                        <th>标准值</th>
                                                                        <th>实测值</th>
                                                                        <th>状态</th>
                                                                        <th>完成时间</th>
                                                                        <th>操作</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td>绝缘电阻测量</td>
                                                                        <td>≥1000MΩ</td>
                                                                        <td>
                                                                            <input type="number" class="form-control form-control-sm" placeholder="输入测量值">
                                                                        </td>
                                                                        <td>
                                                                            <select class="form-select form-select-sm">
                                                                                <option value="pending">待检</option>
                                                                                <option value="normal">正常</option>
                                                                                <option value="abnormal">异常</option>
                                                                            </select>
                                                                        </td>
                                                                        <td>
                                                                            <input type="text" class="form-control form-control-sm" placeholder="添加备注">
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>油温检测</td>
                                                                        <td>≤65℃</td>
                                                                        <td>
                                                                            <input type="number" class="form-control form-control-sm" placeholder="输入测量值">
                                                                        </td>
                                                                        <td>
                                                                            <select class="form-select form-select-sm">
                                                                                <option value="pending">待检</option>
                                                                                <option value="normal">正常</option>
                                                                                <option value="abnormal">异常</option>
                                                                            </select>
                                                                        </td>
                                                                        <td>
                                                                            <input type="text" class="form-control form-control-sm" placeholder="添加备注">
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>声音振动检查</td>
                                                                        <td>无异常</td>
                                                                        <td>
                                                                            <input type="text" class="form-control form-control-sm" placeholder="输入检查结果">
                                                                        </td>
                                                                        <td>
                                                                            <select class="form-select form-select-sm">
                                                                                <option value="pending">待检</option>
                                                                                <option value="normal">正常</option>
                                                                                <option value="abnormal">异常</option>
                                                                            </select>
                                                                        </td>
                                                                        <td>
                                                                            <input type="text" class="form-control form-control-sm" placeholder="添加备注">
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>

                                                    <!-- 工作记录 -->
                                                    <div class="col-12 mt-4">
                                                        <h6 class="mb-3">工作记录</h6>
                                                        <div class="work-log">
                                                            <div class="log-item">
                                                                <div class="log-time">09:00</div>
                                                                <div class="log-content">
                                                                    <h6>开始检修工作</h6>
                                                                    <p>按计划开始主变压器#1的例行检修工作</p>
                                                                </div>
                                                            </div>
                                                            <div class="log-item">
                                                                <div class="log-time">09:15</div>
                                                                <div class="log-content">
                                                                    <h6>完成绝缘电阻测量</h6>
                                                                    <p>测量值: 1200MΩ，状态正常</p>
                                                                </div>
                                                            </div>
                                                            <div class="log-item">
                                                                <div class="log-time">09:30</div>
                                                                <div class="log-content">
                                                                    <h6>进行油温检测</h6>
                                                                    <p>当前进行油温检测工作，等待数据稳定</p>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <!-- 添加记录 -->
                                                        <div class="add-log mt-3">
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" placeholder="添加工作记录...">
                                                                <button class="btn btn-primary" type="button">添加</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 右侧：无人机巡检 -->
                                    <div class="col-xl-3">
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">无人机巡检</h5>
                                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newDroneTaskModal">
                                                        <i class="ri-add-line align-middle me-1"></i>新建巡检
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <!-- 无人机状态 -->
                                                <div class="drone-status mb-4">
                                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                                        <h6 class="mb-0">无人机状态</h6>
                                                        <div class="drone-battery">
                                                            <i class="ri-battery-2-line me-1"></i>
                                                            <span>85%</span>
                                                        </div>
                                                    </div>
                                                    <div class="drone-info">
                                                        <div class="info-item">
                                                            <span class="info-label">设备编号:</span>
                                                            <span class="info-value">DRONE-001</span>
                                                        </div>
                                                        <div class="info-item">
                                                            <span class="info-label">当前状态:</span>
                                                            <span class="info-value text-success">待命中</span>
                                                        </div>
                                                        <div class="info-item">
                                                            <span class="info-label">剩余续航:</span>
                                                            <span class="info-value">25分钟</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- 巡检任务列表 -->
                                                <div class="drone-tasks">
                                                    <h6 class="mb-3">巡检任务</h6>
                                                    <div class="task-list">
                                                        <!-- 由JS动态生成内容 -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 检修策略管理面板 -->
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">检修策略管理</h5>
                                                    <button class="btn btn-primary btn-sm" onclick="maintenanceManagement.createStrategy()">
                                                        <i class="ri-add-line align-middle me-1"></i>新建策略
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div class="strategy-list">
                                                    <!-- 预防性维护策略 -->
                                                    <div class="strategy-item active">
                                                        <div class="strategy-header">
                                                            <h6>预防性维护策略</h6>
                                                            <div class="strategy-status">
                                                                <span class="badge bg-success">运行中</span>
                                                            </div>
                                                        </div>
                                                        <div class="strategy-details">
                                                            <div class="detail-item">
                                                                <span class="label">检修周期:</span>
                                                                <span class="value">30天</span>
                                                            </div>
                                                            <div class="detail-item">
                                                                <span class="label">上次执行:</span>
                                                                <span class="value">2024-03-01</span>
                                                            </div>
                                                            <div class="detail-item">
                                                                <span class="label">覆盖设备:</span>
                                                                <span class="value">35台</span>
                                                            </div>
                                                        </div>
                                                        <div class="strategy-actions">
                                                            <button class="btn btn-sm btn-light" onclick="maintenanceManagement.editStrategy('prev-001')">
                                                                <i class="ri-edit-line"></i>
                                                            </button>
                                                            <button class="btn btn-sm btn-light" onclick="maintenanceManagement.pauseStrategy('prev-001')">
                                                                <i class="ri-pause-line"></i>
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <!-- 预测性维护策略 -->
                                                    <div class="strategy-item">
                                                        <div class="strategy-header">
                                                            <h6>预测性维护策略</h6>
                                                            <div class="strategy-status">
                                                                <span class="badge bg-warning">测试中</span>
                                                            </div>
                                                        </div>
                                                        <div class="strategy-details">
                                                            <div class="detail-item">
                                                                <span class="label">监测指标:</span>
                                                                <span class="value">温度,振动</span>
                                                            </div>
                                                            <div class="detail-item">
                                                                <span class="label">预警阈值:</span>
                                                                <span class="value">85%</span>
                                                            </div>
                                                            <div class="detail-item">
                                                                <span class="label">覆盖设备:</span>
                                                                <span class="value">12台</span>
                                                            </div>
                                                        </div>
                                                        <div class="strategy-actions">
                                                            <button class="btn btn-sm btn-light" onclick="maintenanceManagement.editStrategy('pred-001')">
                                                                <i class="ri-edit-line"></i>
                                                            </button>
                                                            <button class="btn btn-sm btn-light" onclick="maintenanceManagement.activateStrategy('pred-001')">
                                                                <i class="ri-play-line"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 巡检执行状态 -->
                                        <div class="card">
                                            <div class="card-header">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <h5 class="card-title mb-0">巡检执行状态</h5>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-light active" data-view="list">
                                                            <i class="ri-list-check"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-light" data-view="map">
                                                            <i class="ri-map-2-line"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body">
                                                <div class="inspection-status">
                                                    <!-- 实时进度 -->
                                                    <div class="progress-section mb-3">
                                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                                            <h6 class="mb-0">当前任务进度</h6>
                                                            <span class="text-success">75%</span>
                                                        </div>
                                                        <div class="progress" style="height: 6px;">
                                                            <div class="progress-bar bg-success" role="progressbar" style="width: 75%"></div>
                                                        </div>
                                                    </div>

                                                    <!-- 检查点状态 -->
                                                    <div class="checkpoints mb-3">
                                                        <h6 class="mb-2">检查点状态</h6>
                                                        <div class="checkpoint-list">
                                                            <div class="checkpoint-item completed">
                                                                <i class="ri-checkbox-circle-line"></i>
                                                                <span>变压器检查</span>
                                                                <small>10:15</small>
                                                            </div>
                                                            <div class="checkpoint-item completed">
                                                                <i class="ri-checkbox-circle-line"></i>
                                                                <span>线路巡检</span>
                                                                <small>10:30</small>
                                                            </div>
                                                            <div class="checkpoint-item active">
                                                                <i class="ri-time-line"></i>
                                                                <span>设备测温</span>
                                                                <small>进行中</small>
                                                            </div>
                                                            <div class="checkpoint-item">
                                                                <i class="ri-radio-button-line"></i>
                                                                <span>数据采集</span>
                                                                <small>待执行</small>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- 实时告警 -->
                                                    <div class="realtime-alerts">
                                                        <h6 class="mb-2">实时告警</h6>
                                                        <div class="alert-list">
                                                            <div class="alert-item warning">
                                                                <i class="ri-error-warning-line"></i>
                                                                <div class="alert-content">
                                                                    <h6>设备温度异常</h6>
                                                                    <p>变压器#3温度超过阈值</p>
                                                                    <small>2分钟前</small>
                                                                </div>
                                                                <button class="btn btn-sm btn-light">处理</button>
                                                            </div>
                                                            <div class="alert-item info">
                                                                <i class="ri-information-line"></i>
                                                                <div class="alert-content">
                                                                    <h6>巡检完成提醒</h6>
                                                                    <p>A区域巡检任务已完成</p>
                                                                    <small>5分钟前</small>
                                                                </div>
                                                                <button class="btn btn-sm btn-light">查看</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 充电桩管理页面 -->
                            <div class="tab-pane" id="charging-management" role="tabpanel">
                                <!-- 顶部统计卡片 -->
                                <div class="row mb-4">
                                    <div class="col-xl-3 col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <h4 class="mb-1 font-size-24" id="total-stations">128</h4>
                                                        <p class="text-muted mb-0">总充电桩数</p>
                                            </div>
                                                    <div class="avatar-sm rounded-circle bg-primary align-self-center">
                                                        <span class="avatar-title rounded-circle bg-primary">
                                                            <i class="ri-charging-pile-2-line font-size-24"></i>
                                                        </span>
                                            </div>
                                        </div>
                                    </div>
                                            <div class="card-footer bg-transparent border-top">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <span class="text-success"><i class="ri-arrow-up-line align-middle"></i> +8</span>
                                            </div>
                                                    <div class="flex-shrink-0">
                                                        <span class="text-muted">较上月</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <h4 class="mb-1 font-size-24" id="device-health">96.8%</h4>
                                                        <p class="text-muted mb-0">设备健康率</p>
                                            </div>
                                                    <div class="avatar-sm rounded-circle bg-success align-self-center">
                                                        <span class="avatar-title rounded-circle bg-success">
                                                            <i class="ri-pulse-line font-size-24"></i>
                                                        </span>
                                            </div>
                                        </div>
                                    </div>
                                            <div class="card-footer bg-transparent border-top">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <span class="text-success"><i class="ri-arrow-up-line align-middle"></i> +2.3%</span>
                                            </div>
                                                    <div class="flex-shrink-0">
                                                        <span class="text-muted">较上月</span>
                                            </div>
                                        </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <h4 class="mb-1 font-size-24" id="today-charging">2,586</h4>
                                                        <p class="text-muted mb-0">今日充电量(kWh)</p>
                                            </div>
                                                    <div class="avatar-sm rounded-circle bg-info align-self-center">
                                                        <span class="avatar-title rounded-circle bg-info">
                                                            <i class="ri-battery-2-charge-line font-size-24"></i>
                                                        </span>
                                                </div>
                                            </div>
                                        </div>
                                            <div class="card-footer bg-transparent border-top">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <span class="text-success"><i class="ri-arrow-up-line align-middle"></i> +15.2%</span>
                                                    </div>
                                                    <div class="flex-shrink-0">
                                                        <span class="text-muted">较昨日</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xl-3 col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <h4 class="mb-1 font-size-24" id="today-income">¥3,856.50</h4>
                                                        <p class="text-muted mb-0">今日收益</p>
                                            </div>
                                                    <div class="avatar-sm rounded-circle bg-warning align-self-center">
                                                        <span class="avatar-title rounded-circle bg-warning">
                                                            <i class="ri-money-cny-circle-line font-size-24"></i>
                                                        </span>
                                                </div>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-transparent border-top">
                                                <div class="d-flex align-items-center">
                                                    <div class="flex-grow-1">
                                                        <span class="text-success"><i class="ri-arrow-up-line align-middle"></i> +12.8%</span>
                                                    </div>
                                                    <div class="flex-shrink-0">
                                                        <span class="text-muted">较昨日</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>

                                <!-- 功能按钮区 -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-primary" onclick="refreshCharts()">
                                                    <i class="ri-refresh-line align-middle me-1"></i>刷新数据
                                                </button>
                                                <button type="button" class="btn btn-success" onclick="exportData()">
                                                    <i class="ri-file-excel-line align-middle me-1"></i>导出数据
                                                </button>
                                                <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#addStationModal">
                                                    <i class="ri-add-line align-middle me-1"></i>新增站点
                                                </button>
                                            </div>
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-light active" onclick="showAllStations()">全部</button>
                                                <button type="button" class="btn btn-light" onclick="showFastStations()">快充站</button>
                                                <button type="button" class="btn btn-light" onclick="showSlowStations()">慢充站</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 主要内容区域 -->
                                <div class="row">
                                    <!-- 左侧：充电站分布图和监控 -->
                                    <div class="col-xl-8">
                                        <!-- 分布图 -->
                                        <div class="card mb-4">
                                            <div class="card-body">
                                                <div id="distribution-map" style="height: 500px;"></div>
                                            </div>
                                        </div>

                                        <!-- 调度操作面板 -->
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-center mb-4">
                                                    <h5 class="card-title mb-0">调度操作面板</h5>
                                                    <div class="btn-group">
                                                        <button class="btn btn-primary" onclick="batchDispatch()">
                                                            <i class="ri-function-line me-1"></i>批量调度
                                                        </button>
                                                        <button class="btn btn-success" onclick="optimizeLoad()">
                                                            <i class="ri-equalizer-line me-1"></i>负载优化
                                                        </button>
                                                        <button class="btn btn-info" onclick="emergencyMode()">
                                                            <i class="ri-alarm-warning-line me-1"></i>应急模式
                                                        </button>
                                                    </div>
                                                </div>

                                                <!-- 快速操作区 -->
                                                <div class="quick-actions mb-4">
                                                    <div class="row g-2">
                                                        <div class="col-md-3">
                                                            <div class="card bg-soft-primary">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-1">功率调节</h6>
                                                                    <div class="input-group input-group-sm">
                                                                        <input type="number" class="form-control" id="powerAdjust" placeholder="输入功率值">
                                                                        <span class="input-group-text">kW</span>
                                                                        <button class="btn btn-primary" onclick="adjustPower()">调节</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="card bg-soft-success">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-1">价格调整</h6>
                                                                    <div class="input-group input-group-sm">
                                                                        <input type="number" class="form-control" id="priceAdjust" placeholder="输入价格">
                                                                        <span class="input-group-text">元</span>
                                                                        <button class="btn btn-success" onclick="adjustPrice()">调整</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="card bg-soft-warning">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-1">限流控制</h6>
                                                                    <div class="input-group input-group-sm">
                                                                        <input type="number" class="form-control" id="currentLimit" placeholder="输入电流值">
                                                                        <span class="input-group-text">A</span>
                                                                        <button class="btn btn-warning" onclick="limitCurrent()">限制</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3">
                                                            <div class="card bg-soft-info">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-1">模式切换</h6>
                                                                    <select class="form-select form-select-sm" id="operationMode" onchange="switchMode(this.value)">
                                                                        <option value="normal">正常模式</option>
                                                                        <option value="eco">节能模式</option>
                                                                        <option value="fast">快充模式</option>
                                                                        <option value="maintenance">维护模式</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                            </div>
                                        </div>

                                                <!-- 调度任务列表 -->
                                                <div class="dispatch-tasks">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                        <h6 class="mb-0">调度任务列表</h6>
                                                        <button class="btn btn-sm btn-light" onclick="refreshTasks()">
                                                            <i class="ri-refresh-line"></i>
                                                        </button>
                                                    </div>
                                                    <div class="table-responsive">
                                                        <table class="table table-sm">
                                                            <thead>
                                                                <tr>
                                                                    <th>任务ID</th>
                                                                    <th>类型</th>
                                                                    <th>目标站点</th>
                                                                    <th>调度值</th>
                                                                    <th>执行时间</th>
                                                                    <th>状态</th>
                                                                    <th>操作</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="dispatchTasksList">
                                                                <tr>
                                                                    <td>TASK-001</td>
                                                                    <td>功率调节</td>
                                                                    <td>高新区A站</td>
                                                                    <td>120kW</td>
                                                                    <td>2024-03-26 15:30</td>
                                                                    <td><span class="badge bg-warning">待执行</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-primary" onclick="executeTask('TASK-001')">执行</button>
                                                                        <button class="btn btn-sm btn-danger" onclick="cancelTask('TASK-001')">取消</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-002</td>
                                                                    <td>价格调整</td>
                                                                    <td>天府新区B站</td>
                                                                    <td>1.8元/kWh</td>
                                                                    <td>2024-03-26 16:00</td>
                                                                    <td><span class="badge bg-info">已调度</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-secondary" onclick="viewTaskDetail('TASK-002')">详情</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-003</td>
                                                                    <td>限流控制</td>
                                                                    <td>武侯区C站</td>
                                                                    <td>180A</td>
                                                                    <td>2024-03-26 16:15</td>
                                                                    <td><span class="badge bg-success">已完成</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-secondary" onclick="viewTaskDetail('TASK-003')">详情</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-004</td>
                                                                    <td>模式切换</td>
                                                                    <td>锦江区D站</td>
                                                                    <td>快充模式</td>
                                                                    <td>2024-03-26 16:30</td>
                                                                    <td><span class="badge bg-warning">待执行</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-primary" onclick="executeTask('TASK-004')">执行</button>
                                                                        <button class="btn btn-sm btn-danger" onclick="cancelTask('TASK-004')">取消</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-005</td>
                                                                    <td>批量调度</td>
                                                                    <td>高新区站群</td>
                                                                    <td>功率-80%</td>
                                                                    <td>2024-03-26 17:00</td>
                                                                    <td><span class="badge bg-warning">待执行</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-primary" onclick="executeTask('TASK-005')">执行</button>
                                                                        <button class="btn btn-sm btn-danger" onclick="cancelTask('TASK-005')">取消</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-006</td>
                                                                    <td>负载优化</td>
                                                                    <td>天府新区站群</td>
                                                                    <td>智能分配</td>
                                                                    <td>2024-03-26 17:30</td>
                                                                    <td><span class="badge bg-primary">执行中</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-secondary" onclick="viewTaskDetail('TASK-006')">详情</button>
                                                                        <button class="btn btn-sm btn-warning" onclick="pauseTask('TASK-006')">暂停</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-007</td>
                                                                    <td>应急控制</td>
                                                                    <td>成华区E站</td>
                                                                    <td>紧急降载</td>
                                                                    <td>2024-03-26 15:45</td>
                                                                    <td><span class="badge bg-success">已完成</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-secondary" onclick="viewTaskDetail('TASK-007')">详情</button>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>TASK-008</td>
                                                                    <td>价格调整</td>
                                                                    <td>全市站点</td>
                                                                    <td>1.5元/kWh</td>
                                                                    <td>2024-03-26 18:00</td>
                                                                    <td><span class="badge bg-warning">待执行</span></td>
                                                                    <td>
                                                                        <button class="btn btn-sm btn-primary" onclick="executeTask('TASK-008')">执行</button>
                                                                        <button class="btn btn-sm btn-danger" onclick="cancelTask('TASK-008')">取消</button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 右侧：实时监控和告警信息 -->
                                    <div class="col-xl-4">
                                        <!-- 实时监控状态 -->
                                        <div class="card mb-4">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <h5 class="card-title mb-0">实时监控状态</h5>
                                                    <div class="dropdown">
                                                        <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                                            <i class="ri-settings-3-line align-middle"></i>
                                                        </button>
                                                        <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" href="#" onclick="refreshMonitoringStatus()">刷新状态</a></li>
                                                            <li><a class="dropdown-item" href="#" onclick="exportMonitoringData()">导出数据</a></li>
                                                            <li><hr class="dropdown-divider"></li>
                                                            <li><a class="dropdown-item" href="#" onclick="configureMonitoring()">监控配置</a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="monitoring-stats">
                                                    <div class="row g-0">
                                                        <div class="col-4">
                                                            <div class="p-3 border-end">
                                                                <h5 class="mb-1" id="free-stations">35</h5>
                                                                <p class="text-muted mb-0">空闲站点</p>
                                            </div>
                                        </div>
                                                        <div class="col-4">
                                                            <div class="p-3 border-end">
                                                                <h5 class="mb-1" id="charging-stations">82</h5>
                                                                <p class="text-muted mb-0">充电中</p>
                                                    </div>
                                                </div>
                                                        <div class="col-4">
                                                            <div class="p-3">
                                                                <h5 class="mb-1" id="fault-stations">11</h5>
                                                                <p class="text-muted mb-0">故障站点</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 告警信息 -->
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <h5 class="card-title mb-0">告警信息</h5>
                                                    <button class="btn btn-light btn-sm" onclick="viewAlarmHistory()">
                                                        <i class="ri-history-line align-middle"></i>历史记录
                                                    </button>
                                                </div>
                                                <div class="alarm-list">
                                                    <div class="alert alert-warning d-flex align-items-center mb-2">
                                                        <i class="ri-error-warning-line me-2"></i>
                                                        <div>
                                                            <h6 class="alert-heading mb-1">高新区A站 #5端口过温</h6>
                                                            <small class="text-muted">2024-03-26 10:15:23</small>
                                                        </div>
                                                    </div>
                                                    <div class="alert alert-danger d-flex align-items-center mb-2">
                                                        <i class="ri-alarm-warning-line me-2"></i>
                                                        <div>
                                                            <h6 class="alert-heading mb-1">天府新区B站通信中断</h6>
                                                            <small class="text-muted">2024-03-26 09:30:15</small>
                                                        </div>
                                                    </div>
                                                    <div class="alert alert-info d-flex align-items-center">
                                                        <i class="ri-information-line me-2"></i>
                                                        <div>
                                                            <h6 class="alert-heading mb-1 ">武侯区C站设备维护完成</h6>
                                                            <small class="text-muted">2024-03-26 08:45:30</small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 调度策略模块 -->
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-center mb-3">
                                                    <h5 class="card-title mb-0">调度策略</h5>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-success" onclick="saveStrategy()">
                                                            <i class="ri-save-line me-1"></i>保存
                                                        </button>
                                                        <button class="btn btn-sm btn-primary" onclick="applyStrategy()">
                                                            <i class="ri-play-circle-line me-1"></i>应用
                                                        </button>
                    </div>
                </div>

                                                <!-- 策略配置区 -->
                                                <div class="strategy-config mb-3">
                                                    <div class="row g-2">
                                                        <!-- 运行模式 -->
                                                        <div class="col-6">
                                                            <div class="card bg-soft-primary">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-2">运行模式</h6>
                                                                    <select class="form-select form-select-sm" id="runningMode">
                                                                        <option value="auto">自动调度</option>
                                                                        <option value="manual">手动控制</option>
                                                                        <option value="eco">节能模式</option>
                                                                        <option value="peak">高峰应对</option>
                                                                    </select>
        </div>
                </div>
            </div>
                                                        <!-- 负载均衡 -->
                                                        <div class="col-6">
                                                            <div class="card bg-soft-success">
                                                                <div class="card-body p-2">
                                                                    <h6 class="mb-2">负载均衡</h6>
                                                                    <select class="form-select form-select-sm" id="loadBalance">
                                                                        <option value="smart">智能分配</option>
                                                                        <option value="even">均匀分配</option>
                                                                        <option value="priority">优先级分配</option>
                                </select>
                            </div>
                            </div>
                                </div>
                                                        <!-- 高峰时段 -->
                                                        <div class="col-12">
                                                            <div class="card bg-soft-warning">
                                                                <div class="card-body p-2">
                                                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                                                        <h6 class="mb-0">高峰时段</h6>
                                                                        <div class="form-check form-switch">
                                                                            <input class="form-check-input" type="checkbox" id="peakTimeEnabled">
                            </div>
                                </div>
                                                                    <div class="row g-1">
                                                                        <div class="col-6">
                                                                            <div class="input-group input-group-sm">
                                                                                <span class="input-group-text">开始</span>
                                                                                <input type="time" class="form-control" value="08:00" id="peakTimeStart">
                            </div>
                    </div>
                                                                        <div class="col-6">
                                                                            <div class="input-group input-group-sm">
                                                                                <span class="input-group-text">结束</span>
                                                                                <input type="time" class="form-control" value="20:00" id="peakTimeEnd">
                    </div>
                </div>
            </div>
        </div>
                    </div>
                                </div>
                                </div>
                                </div>

                                                <!-- 策略参数 -->
                                                <div class="strategy-params">
                                                    <h6 class="mb-3">策略参数</h6>
                                                    <div class="row g-2">
                                                        <!-- 最大功率限制 -->
                                                        <div class="col-6">
                                                            <label class="form-label small">最大功率限制</label>
                                                            <div class="input-group input-group-sm">
                                                                <input type="number" class="form-control" value="120" id="maxPowerLimit">
                                                                <span class="input-group-text">kW</span>
                                </div>
                            </div>
                                                        <!-- 最小功率保证 -->
                                                        <div class="col-6">
                                                            <label class="form-label small">最小功率保证</label>
                                                            <div class="input-group input-group-sm">
                                                                <input type="number" class="form-control" value="30" id="minPowerGuarantee">
                                                                <span class="input-group-text">kW</span>
                                </div>
                                </div>
                                                        <!-- 响应时间 -->
                                                        <div class="col-6">
                                                            <label class="form-label small">响应时间</label>
                                                            <div class="input-group input-group-sm">
                                                                <input type="number" class="form-control" value="3" id="responseTime">
                                                                <span class="input-group-text">秒</span>
                                    </div>
                                </div>
                                                        <!-- 缓冲时间 -->
                                                        <div class="col-6">
                                                            <label class="form-label small">缓冲时间</label>
                                                            <div class="input-group input-group-sm">
                                                                <input type="number" class="form-control" value="5" id="bufferTime">
                                                                <span class="input-group-text">分钟</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                                                <!-- 优先级设置 -->
                                                <div class="priority-settings mt-3">
                                                    <h6 class="mb-3">优先级设置</h6>
                            <div class="table-responsive">
                                                        <table class="table table-sm">
                                    <thead>
                                        <tr>
                                                                    <th>充电类型</th>
                                                                    <th>优先级</th>
                                                                    <th>功率分配</th>
                                        </tr>
                                    </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>快充</td>
                                                                    <td>
                                                                        <select class="form-select form-select-sm">
                                                                            <option value="1">高</option>
                                                                            <option value="2">中</option>
                                                                            <option value="3">低</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input type="number" class="form-control form-control-sm" value="60">
                                                                    </td>
                                        </tr>
                                        <tr>
                                                                    <td>慢充</td>
                                                                    <td>
                                                                        <select class="form-select form-select-sm">
                                                                            <option value="1">高</option>
                                                                            <option value="2" selected>中</option>
                                                                            <option value="3">低</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <input type="number" class="form-control form-control-sm" value="40">
                                                                    </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                                                <!-- 调度日志 -->
                                                <div class="dispatch-log mt-3">
                                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                                        <h6 class="mb-0">调度日志</h6>
                                                        <button class="btn btn-sm btn-light" onclick="clearLog()">
                                                            <i class="ri-delete-bin-line"></i>
                                                        </button>
                    </div>
                                                    <div class="log-container" style="height: 120px; overflow-y: auto;">
                                                        <div class="log-item">
                                                            <small class="text-muted">10:30:15</small>
                                                            <span class="text-success">自动切换到高峰模式</span>
                    </div>
                                                        <div class="log-item">
                                                            <small class="text-muted">10:15:30</small>
                                                            <span class="text-info">负载均衡调整完成</span>
                                                        </div>
                                                        <div class="log-item">
                                                            <small class="text-muted">10:00:00</small>
                                                            <span class="text-warning">触发功率限制策略</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                </div>
                <footer class="footer">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-6">
                                <script>document.write(new Date().getFullYear())</script> © 驭能能源管理系统.
                            </div>
                            <div class="col-sm-6">
                                <div class="text-sm-end d-none d-sm-block">
                                    <p class="mb-0">由 <i class="mdi mdi-heart text-danger"></i> 404REBORN 倾情打造 </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>

            </div> <!-- end slimscroll-menu-->
        </div>
        <!-- Right Sidebar -->
        <div class="right-bar">
            <div data-simplebar="" class="h-100">
                <div class="rightbar-title d-flex align-items-center bg-dark p-3">

                    <h5 class="m-0 me-2 text-white">Theme Customizer</h5>

                    <a href="javascript:void(0);" class="right-bar-toggle ms-auto">
                        <i class="mdi mdi-close noti-icon"></i>
                    </a>
                </div>

                <!-- Settings -->
                <hr class="m-0">

                <div class="p-4">
                    <h6 class="mb-3">Layout</h6>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout" id="layout-vertical" value="vertical">
                        <label class="form-check-label" for="layout-vertical">Vertical</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout" id="layout-horizontal" value="horizontal">
                        <label class="form-check-label" for="layout-horizontal">Horizontal</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2">Layout Mode</h6>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-mode" id="layout-mode-light" value="light">
                        <label class="form-check-label" for="layout-mode-light">Light</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-mode" id="layout-mode-dark" value="dark">
                        <label class="form-check-label" for="layout-mode-dark">Dark</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2">Layout Width</h6>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-width" id="layout-width-fuild" value="fuild" onchange="document.body.setAttribute('data-layout-size', 'fluid')">
                        <label class="form-check-label" for="layout-width-fuild">Fluid</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-width" id="layout-width-boxed" value="boxed" onchange="document.body.setAttribute('data-layout-size', 'boxed')">
                        <label class="form-check-label" for="layout-width-boxed">Boxed</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2">Layout Position</h6>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-position" id="layout-position-fixed" value="fixed" onchange="document.body.setAttribute('data-layout-scrollable', 'false')">
                        <label class="form-check-label" for="layout-position-fixed">Fixed</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-position" id="layout-position-scrollable" value="scrollable" onchange="document.body.setAttribute('data-layout-scrollable', 'true')">
                        <label class="form-check-label" for="layout-position-scrollable">Scrollable</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2">Topbar Color</h6>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="topbar-color" id="topbar-color-light" value="light" onchange="document.body.setAttribute('data-topbar', 'light')">
                        <label class="form-check-label" for="topbar-color-light">Light</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="topbar-color" id="topbar-color-dark" value="dark" onchange="document.body.setAttribute('data-topbar', 'dark')">
                        <label class="form-check-label" for="topbar-color-dark">Dark</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2 sidebar-setting">Sidebar Size</h6>

                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-size" id="sidebar-size-default" value="default" onchange="document.body.setAttribute('data-sidebar-size', 'lg')">
                        <label class="form-check-label" for="sidebar-size-default">Default</label>
                    </div>
                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-size" id="sidebar-size-compact" value="compact" onchange="document.body.setAttribute('data-sidebar-size', 'md')">
                        <label class="form-check-label" for="sidebar-size-compact">Compact</label>
                    </div>
                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-size" id="sidebar-size-small" value="small" onchange="document.body.setAttribute('data-sidebar-size', 'sm')">
                        <label class="form-check-label" for="sidebar-size-small">Small (Icon View)</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2 sidebar-setting">Sidebar Color</h6>

                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-color" id="sidebar-color-light" value="light" onchange="document.body.setAttribute('data-sidebar', 'light')">
                        <label class="form-check-label" for="sidebar-color-light">Light</label>
                    </div>
                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-color" id="sidebar-color-dark" value="dark" onchange="document.body.setAttribute('data-sidebar', 'dark')">
                        <label class="form-check-label" for="sidebar-color-dark">Dark</label>
                    </div>
                    <div class="form-check sidebar-setting">
                        <input class="form-check-input" type="radio" name="sidebar-color" id="sidebar-color-brand" value="brand" onchange="document.body.setAttribute('data-sidebar', 'brand')">
                        <label class="form-check-label" for="sidebar-color-brand">Brand</label>
                    </div>

                    <h6 class="mt-4 mb-3 pt-2">Direction</h6>

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-direction" id="layout-direction-ltr" value="ltr">
                        <label class="form-check-label" for="layout-direction-ltr">LTR</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="layout-direction" id="layout-direction-rtl" value="rtl">
                        <label class="form-check-label" for="layout-direction-rtl">RTL</label>
                    </div>

                    <!-- 添加主题切换控制 -->
                    <div class="theme-settings">
                        <div class="theme-colors">
                            <h6>主题颜色</h6>
                            <div class="color-options">
                                <button class="color-option" data-theme="default"></button>
                                <button class="color-option" data-theme="dark"></button>
                                <button class="color-option" data-theme="blue"></button>
                                <button class="color-option" data-theme="green"></button>
                            </div>
                        </div>
                        <div class="theme-fonts">
                            <h6>字体设置</h6>
                            <select class="form-select form-select-sm">
                                <option value="default">默认字体</option>
                                <option value="microsoft">微软雅黑</option>
                                <option value="pingfang">苹方</option>
                            </select>
                        </div>
                    </div>
                </div>

            </div> <!-- end slimscroll-menu-->
        </div>
        <!-- /Right-bar -->

<!-- Right bar overlay-->
<div class="rightbar-overlay"></div>

        <!-- 引入模态框组件 -->
        <div id="modalsContainer">
            <!-- 这里将包含 business-modals.html 的内容 -->
        </div>

        <!-- JAVASCRIPT -->
        <script src="static/js/jquery.min.js"></script>
        <script src="static/js/bootstrap.bundle.min.js"></script>
        <script src="static/js/metisMenu.min.js"></script>
        <script src="static/js/simplebar.min.js"></script>
        <script src="static/js/waves.min.js"></script>
        <script src="static/js/feather.min.js"></script>
        <!-- pace js -->
        <script src="static/js/pace.min.js"></script>

        <!-- apexcharts -->
        <script src="static/js/apexcharts.min.js"></script>

        <!-- 添加必要的依赖 -->
        <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

        <!-- App js -->
        <script src="static/js/app.js"></script>
        <script src="static/js/business-charts.js"></script>
        <script src="static/js/business-trading.js"></script>
        <script src="static/js/trading-charts.js"></script>
        <script src="static/js/maintenance-management.js"></script>
        <script src="static/js/maintenance-work-order.js"></script>
        <script src="static/js/business-modals.js"></script>
        <script type="module" src="static/js/business-processor.js"></script>
        <script src="static/js/dispatch-strategy.js"></script>

        <!-- 电力调度相关脚本 -->
        <script src="static/js/power-dispatch-charts.js"></script>
        <script src="static/js/power-dispatch-commands.js"></script>
        <script src="static/js/power-dispatch-management.js"></script>
        <script src="static/js/power-dispatch-control.js"></script>

        <script>
            // 等待所有资源加载完成
            window.addEventListener('load', function() {
                // 直接初始化（不再从 templates 目录动态加载，避免404内容被注入）
                if (window.BusinessModals) {
                    window.BusinessModals.initialize();
                }

                // 初始化业务处理器
                if (window.BusinessProcessor) {
                    window.BusinessProcessor.init();

                    // 显示调度记录
                    window.BusinessProcessor.recordProcessor.updateRecordDisplay('dispatch');

                    // 绑定标签页切换事件，显示对应类型的记录
                    document.querySelectorAll('a[data-bs-toggle="tab"]').forEach(tab => {
                        tab.addEventListener('shown.bs.tab', (e) => {
                            const type = e.target.getAttribute('href').replace('#', '').split('-')[0];
                            if (type && ['dispatch', 'trading', 'maintenance', 'charging'].includes(type)) {
                                window.BusinessProcessor.recordProcessor.updateRecordDisplay(type);
                                // 内容更新后重新初始化模态框事件
                                if (window.BusinessModals) {
                                    window.BusinessModals.initialize();
                                }
                            }
                        });
                    });
                }

                // 初始化交易图表
                if (window.TradingCharts) {
                    window.tradingCharts = new TradingCharts();
                }

                // 初始化设备检修管理
                if (window.MaintenanceManagement) {
                    window.maintenanceManagement = new MaintenanceManagement();
                }

                // 初始化电力调度指令管理
                if (window.PowerDispatchCommands) {
                    window.powerDispatchCommands = new PowerDispatchCommands();
                }
            });
        </script>

        <!-- ECharts 库 -->
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
        <!-- ECharts 中国地图数据 -->
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/map/js/china.js"></script>
        <!-- 充电桩管理系统相关脚本 -->
        <script src="static/js/charging-station-fds.js"></script>
        <script src="static/js/charging-station-fhs.js"></script>
        <script src="static/js/charging-station.js"></script>
        <script src="static/js/charging-management.js"></script>
        <script src="static/js/charging-distribution-map.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // 延迟初始化以确保元素已加载
                setTimeout(() => {
                    try {
                        // 检查是否已加载 ECharts
                        if (typeof echarts === 'undefined') {
                            console.error('ECharts library not found. Please include echarts.min.js');
                            return;
                        }

                        // 检查是否已加载中国地图数据
                        if (!echarts.getMap('china')) {
                            console.error('China map data not found. Please include china.js');
                            return;
                        }

                        // 初始化电力调度图表
                        new PowerDispatchCharts({
                            theme: 'dark'
                        });

                        // 初始化充电桩管理系统
                        if (window.ChargingManagement) {
                            window.chargingManagement = new ChargingManagement();
                        }

                        // 初始化故障诊断系统
                        if (window.FaultDiagnosisSystem) {
                            window.faultDiagnosisSystem = new FaultDiagnosisSystem();
                        }

                        // 初始化故障处理系统
                        if (window.FaultHandlingSystem) {
                            window.faultHandlingSystem = new FaultHandlingSystem();
                        }

                        console.log('All systems initialized successfully');
                    } catch (error) {
                        console.error('Error initializing systems:', error);
                    }
                }, 500);
        });
        </script>

        <!-- 调度控制模态框 -->
        <div class="modal fade" id="dispatchModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content bg-dark">
                    <div class="modal-header bg-primary">
                        <h5 class="modal-title text-white">调度控制</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <!-- 调度控制表单 -->
                        <form id="dispatchForm">
                            <!-- 基本信息 -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label text-light">调度类型</label>
                                        <select class="form-select" id="dispatchType">
                                            <option value="power">功率调节</option>
                                            <option value="angle">角度调整</option>
                                            <option value="mode">模式切换</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label text-light">目标设备</label>
                                        <select class="form-select" id="targetDevice">
                                            <option value="">选择设备...</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 优化配置部分 -->
                            <div id="optimizationConfig">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">优化目标</label>
                                            <select class="form-select" id="optimizationTarget">
                                                <option value="efficiency">效率优化</option>
                                                <option value="cost">成本优化</option>
                                                <option value="balance">负载均衡</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">优化周期</label>
                                            <select class="form-select" id="optimizationPeriod">
                                                <option value="realtime">实时优化</option>
                                                <option value="hourly">每小时优化</option>
                                                <option value="daily">每日优化</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-12">
                                        <label class="form-label text-light">优化参数</label>
                                        <div class="card bg-secondary">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">最小功率限制</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="minPowerLimit">
                                                                <span class="input-group-text">MW</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">最大功率限制</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="maxPowerLimit">
                                                                <span class="input-group-text">MW</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">响应时间</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="responseTime">
                                                                <span class="input-group-text">秒</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">调节步长</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="adjustStep">
                                                                <span class="input-group-text">MW</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 储能控制部分 -->
                            <div id="storageConfig" style="display: none;">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">充放电模式</label>
                                            <select class="form-select" id="chargeMode">
                                                <option value="smart">智能模式</option>
                                                <option value="manual">手动模式</option>
                                                <option value="schedule">计划模式</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">功率设定</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="storagePower">
                                                <span class="input-group-text">MW</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-12">
                                        <label class="form-label text-light">SOC控制范围</label>
                                        <div class="card bg-secondary">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">最小SOC</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="minSoc">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">最大SOC</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="maxSoc">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 负荷控制部分 -->
                            <div id="loadConfig" style="display: none;">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">负荷类型</label>
                                            <select class="form-select" id="loadType">
                                                <option value="industrial">工业负荷</option>
                                                <option value="commercial">商业负荷</option>
                                                <option value="residential">民用负荷</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label text-light">控制方式</label>
                                            <select class="form-select" id="loadControlMode">
                                                <option value="direct">直接控制</option>
                                                <option value="price">价格调节</option>
                                                <option value="demand">需求响应</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-12">
                                        <label class="form-label text-light">负荷控制参数</label>
                                        <div class="card bg-secondary">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">目标负荷</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="targetLoad">
                                                                <span class="input-group-text">MW</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">响应时间</label>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control" id="loadResponseTime">
                                                                <span class="input-group-text">分钟</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 执行时间设置 -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label text-light">执行时间</label>
                                        <input type="datetime-local" class="form-control" id="executeTime">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label text-light">优先级</label>
                                        <select class="form-select" id="priority">
                                            <option value="high">高优先级</option>
                                            <option value="medium">中优先级</option>
                                            <option value="low">低优先级</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 备注说明 -->
                            <div class="mb-3">
                                <label class="form-label text-light">备注说明</label>
                                <textarea class="form-control" id="dispatchNote" rows="3"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer bg-dark border-top border-secondary">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary" id="confirmDispatch">确认下发</button>
                    </div>
                </div>
            </div>
        </div>

       
        <!-- 工单详情模态框 -->
        <div class="modal fade" id="workOrderDetailModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">工单详情 #<span id="workOrderId"></span></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                                <div class="row">
                            <!-- 状态进度 -->
                            <div class="col-12 mb-4">
                                <div class="progress-timeline">
                                    <div class="progress-step completed">
                                        <div class="step-icon">
                                            <i class="ri-file-list-line"></i>
                                        </div>
                                        <div class="step-info">
                                            <h6>创建工单</h6>
                                            <small>2024-04-01 09:00</small>
                                    </div>
                                        </div>
                                    <div class="progress-step active">
                                        <div class="step-icon">
                                            <i class="ri-tools-line"></i>
                                    </div>
                                        <div class="step-info">
                                            <h6>检修中</h6>
                                            <small>2024-04-01 09:15</small>
                                </div>
                                        </div>
                                    <div class="progress-step">
                                        <div class="step-icon">
                                            <i class="ri-check-line"></i>
                                    </div>
                                        <div class="step-info">
                                            <h6>完成检修</h6>
                                            <small>-</small>
                                        </div>
                                    </div>
                                    <div class="progress-step">
                                        <div class="step-icon">
                                            <i class="ri-file-check-line"></i>
                                </div>
                                        <div class="step-info">
                                            <h6>验收确认</h6>
                                            <small>-</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 基本信息 -->
                            <div class="col-md-6 mb-4">
                                <div class="info-card">
                                    <h6 class="card-title">基本信息</h6>
                                    <div class="info-list">
                                        <div class="info-item">
                                            <label>检修类型:</label>
                                            <span id="detailMaintenanceType">例行检修</span>
                                        </div>
                                        <div class="info-item">
                                            <label>优先级:</label>
                                            <span id="detailPriority" class="badge bg-warning">中</span>
                                        </div>
                                        <div class="info-item">
                                            <label>计划时间:</label>
                                            <span id="detailPlannedTime">2024-04-01 09:00</span>
                                        </div>
                                        <div class="info-item">
                                            <label>预计时长:</label>
                                            <span id="detailDuration">4小时</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 设备信息 -->
                            <div class="col-md-6 mb-4">
                                <div class="info-card">
                                    <h6 class="card-title">设备信息</h6>
                                    <div class="info-list">
                                        <div class="info-item">
                                            <label>设备名称:</label>
                                            <span id="detailEquipmentName">主变压器#1</span>
                                        </div>
                                        <div class="info-item">
                                            <label>设备编号:</label>
                                            <span id="detailEquipmentId">TRANS-001</span>
                                    </div>
                                        <div class="info-item">
                                            <label>运行时长:</label>
                                            <span id="detailRunningTime">3650天</span>
                                        </div>
                                        <div class="info-item">
                                            <label>健康状态:</label>
                                            <span id="detailHealthStatus" class="badge bg-success">良好</span>
                                    </div>
                                </div>
                            </div>
                    </div>

                            <!-- 检修进度 -->
                            <div class="col-12 mb-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h6 class="card-title">检修项目进度</h6>
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>检查项目</th>
                                                        <th>标准值</th>
                                                        <th>实测值</th>
                                                        <th>状态</th>
                                                        <th>完成时间</th>
                                                        <th>操作</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="detailItemsList">
                                                    <tr>
                                                        <td>绝缘电阻测量</td>
                                                        <td>≥1000MΩ</td>
                                                        <td>1200MΩ</td>
                                                        <td><span class="badge bg-success">正常</span></td>
                                                        <td>09:15</td>
                                                        <td>
                                                            <button class="btn btn-sm btn-light" onclick="viewItemDetail('item1')">
                                                                <i class="ri-eye-line"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>油温检测</td>
                                                        <td>≤65℃</td>
                                                        <td>58℃</td>
                                                        <td><span class="badge bg-success">正常</span></td>
                                                        <td>09:30</td>
                                                        <td>
                                                            <button class="btn btn-sm btn-light" onclick="viewItemDetail('item2')">
                                                                <i class="ri-eye-line"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>声音振动检查</td>
                                                        <td>无异常</td>
                                                        <td>-</td>
                                                        <td><span class="badge bg-warning">待检</span></td>
                                                        <td>-</td>
                                                        <td>
                                                            <button class="btn btn-sm btn-primary" onclick="updateItemStatus('item3')">
                                                                <i class="ri-edit-line"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                    </div>
                </div>
            </div>
        </div>

                            <!-- 工作记录 -->
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <h6 class="card-title mb-0">工作记录</h6>
                                            <button class="btn btn-sm btn-light" onclick="addWorkLog()">
                                                <i class="ri-add-line"></i> 添加记录
                                            </button>
                    </div>
                                        <div class="work-log-list" id="detailWorkLogs">
                                            <div class="log-item">
                                                <div class="log-time">09:00</div>
                                                <div class="log-content">
                                                    <h6>开始检修工作</h6>
                                                    <p>按计划开始主变压器#1的例行检修工作</p>
                                </div>
                                </div>
                                            <div class="log-item">
                                                <div class="log-time">09:15</div>
                                                <div class="log-content">
                                                    <h6>完成绝缘电阻测量</h6>
                                                    <p>测量值: 1200MΩ，状态正常</p>
                                </div>
                                </div>
                                            <div class="log-item">
                                                <div class="log-time">09:30</div>
                                                <div class="log-content">
                                                    <h6>完成油温检测</h6>
                                                    <p>测量值: 58℃，状态正常</p>
                            </div>
                        </div>
                            </div>
                            </div>
                            </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-success" onclick="maintenanceManagement.completeWorkOrder()">完成工单</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 检查项目详情模态框 -->
        <div class="modal fade" id="itemDetailModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">检查项目详情</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="itemDetailForm">
                            <div class="mb-3">
                                <label class="form-label">检查项目</label>
                                <input type="text" class="form-control" id="itemName" readonly>
                                    </div>
                            <div class="mb-3">
                                <label class="form-label">标准值</label>
                                <input type="text" class="form-control" id="standardValue" readonly>
                                </div>
                            <div class="mb-3">
                                <label class="form-label">实测值</label>
                                <input type="text" class="form-control" id="measuredValue">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">状态</label>
                                <select class="form-select" id="itemStatus">
                                    <option value="normal">正常</option>
                                    <option value="abnormal">异常</option>
                                    <option value="pending">待处理</option>
                                </select>
                                    </div>
                            <div class="mb-3">
                                <label class="form-label">备注说明</label>
                                <textarea class="form-control" id="itemNotes" rows="3"></textarea>
                                </div>
                            <div class="mb-3">
                                <label class="form-label">图片上传</label>
                                <input type="file" class="form-control" id="itemPhotos" multiple accept="image/*">
                            </div>
                        </form>
                        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary" onclick="saveItemDetail()">保存</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 添加工作记录模态框 -->
        <div class="modal fade" id="addWorkLogModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">添加工作记录</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="workLogForm">
                            <div class="mb-3">
                                <label class="form-label">记录类型</label>
                                <select class="form-select" id="logType" required>
                                    <option value="operation">操作记录</option>
                                    <option value="inspection">检查记录</option>
                                    <option value="issue">问题记录</option>
                                    <option value="other">其他</option>
                                </select>
                        </div>
                            <div class="mb-3">
                                <label class="form-label">标题</label>
                                <input type="text" class="form-control" id="logTitle" required>
                    </div>
                            <div class="mb-3">
                                <label class="form-label">内容描述</label>
                                <textarea class="form-control" id="logContent" rows="3" required></textarea>
                </div>
                            <div class="mb-3">
                                <label class="form-label">图片上传</label>
                                <input type="file" class="form-control" id="logPhotos" multiple accept="image/*">
            </div>
                        </form>
        </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary" onclick="saveWorkLog()">保存</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
        function debugMaintenance() {
            console.log('Debug maintenance management');
            if (window.maintenanceWorkOrder) {
                console.log('MaintenanceWorkOrder instance:', window.maintenanceWorkOrder);
                window.maintenanceWorkOrder.loadInitialData();
                window.maintenanceWorkOrder.updateWorkOrdersList();
            } else {
                console.warn('MaintenanceWorkOrder not initialized');
            }
        }
        </script>

        <!-- 引入业务模态框 -->
        

        <!-- 引入业务相关的 JS 文件 -->
        <script src="static/js/maintenance-work-order.js"></script>

        <!-- 在 body 结束标签前添加 -->
        <!-- 引入业务相关的 JS 文件 -->
        <script src="static/js/maintenance-work-order.js"></script>

        <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化工单管理
            if (typeof MaintenanceWorkOrder !== 'undefined') {
                window.maintenanceWorkOrder = new MaintenanceWorkOrder();
            }

            // 绑定新建工单按钮事件
            const createButton = document.querySelector('#newWorkOrderModal .modal-footer .btn-primary');
            if (createButton) {
                createButton.onclick = function() {
                    if (window.maintenanceWorkOrder) {
                        window.maintenanceWorkOrder.createWorkOrder();
                    }
                };
            }
        });
        </script>

        <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 尝试加载业务模态框（增加404内容检测，避免注入404页面）
            fetch('templates/components/business-modals.html')
                .then(response => response.text())
                .then(html => {
                    if (!html) return;
                    const looksLike404 = /<title>\s*404\b/i.test(html) || html.includes('Sorry, page not found');
                    if (looksLike404) return;
                    const container = document.getElementById('modalsContainer');
                    if (container) container.innerHTML = html;

                    // 初始化工单管理
                    if (typeof MaintenanceWorkOrder !== 'undefined') {
                        window.maintenanceWorkOrder = new MaintenanceWorkOrder();
                    }

                    // 绑定新建工单按钮事件
                    const createButton = document.querySelector('#newWorkOrderModal .modal-footer .btn-primary');
                    if (createButton) {
                        createButton.onclick = function() {
                            if (window.maintenanceWorkOrder) {
                                window.maintenanceWorkOrder.createWorkOrder();
                            }
                        };
                    }
                })
                .catch(error => {
                    console.error('加载模态框失败:', error);
                });
        });
        </script>

        <!-- 引入业务相关的 JS 文件 -->
        <script src="static/js/power-dispatch-charts.js"></script>
        <script src="static/js/power-dispatch-management.js"></script>
    </body>
</html>